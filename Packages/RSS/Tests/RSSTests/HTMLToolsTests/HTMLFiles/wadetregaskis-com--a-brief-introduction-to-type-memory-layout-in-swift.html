<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<title>A brief introduction to type memory layout in Swift &#8211; Wade Tregaskis</title>
<meta name='robots' content='max-image-preview:large'/>
<meta name="viewport" content="width=device-width, initial-scale=1"><link rel='dns-prefetch' href='//stats.wp.com'/>
<link rel="alternate" type="application/rss+xml" title="Wade Tregaskis &raquo; Feed" href="https://wadetregaskis.com/feed/"/>
<link rel="alternate" type="application/rss+xml" title="Wade Tregaskis &raquo; Comments Feed" href="https://wadetregaskis.com/comments/feed/"/>
<link rel="alternate" type="application/rss+xml" title="Wade Tregaskis &raquo; A brief introduction to type memory layout in Swift Comments Feed" href="https://wadetregaskis.com/a-brief-introduction-to-type-memory-layout-in-swift/feed/"/>
<link rel="stylesheet" type="text/css" href="//wadetregaskis.com/wp-content/cache/wpfc-minified/9meunufc/hrg5k.css" media="all"/>
<style id='wp-block-library-inline-css'>.has-text-align-justify{text-align:justify;}</style>
<style id='kevinbatdorf-code-block-pro-style-inline-css'>.wp-block-kevinbatdorf-code-block-pro{-webkit-text-size-adjust:100%!important;box-sizing:border-box!important;direction:ltr!important;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;position:relative!important}.wp-block-kevinbatdorf-code-block-pro *{box-sizing:border-box!important}.wp-block-kevinbatdorf-code-block-pro pre,.wp-block-kevinbatdorf-code-block-pro pre *{font-size:inherit!important;line-height:inherit!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre{--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;background-image:none!important;border:0!important;border-radius:0!important;border-style:none!important;border-width:0!important;box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)!important;color:inherit!important;font-family:inherit!important;margin:0!important;overflow:auto!important;overflow-wrap:normal!important;padding:16px 0 16px 16px!important;text-align:left!important;white-space:pre!important}.wp-block-kevinbatdorf-code-block-pro.padding-disabled:not(.code-block-pro-editor) pre{padding:0!important}.wp-block-kevinbatdorf-code-block-pro.padding-bottom-disabled pre{padding-bottom:0!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre code{--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;background:none!important;background-color:transparent!important;border:0!important;border-radius:0!important;border-style:none!important;border-width:0!important;box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)!important;color:inherit!important;display:block!important;font-family:inherit!important;margin:0!important;overflow-wrap:normal!important;padding:0!important;text-align:left!important;white-space:pre!important;width:100%!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre code .line{display:inline-block!important;min-width:var(--cbp-block-width,100%)!important;vertical-align:top!important}.wp-block-kevinbatdorf-code-block-pro.cbp-has-line-numbers:not(.code-block-pro-editor) pre code .line{padding-left:calc(12px + var(--cbp-line-number-width, auto))!important}.wp-block-kevinbatdorf-code-block-pro.cbp-has-line-numbers:not(.code-block-pro-editor) pre code{counter-increment:step calc(var(--cbp-line-number-start, 1) - 1)!important;counter-reset:step!important}.wp-block-kevinbatdorf-code-block-pro pre code .line{position:relative!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre code .line:before{content:""!important;display:inline-block!important}.wp-block-kevinbatdorf-code-block-pro.cbp-has-line-numbers:not(.code-block-pro-editor) pre code .line:not(.cbp-line-number-disabled):before{color:var(--cbp-line-number-color,#999)!important;content:counter(step)!important;counter-increment:step!important;left:0!important;opacity:.5!important;position:absolute!important;text-align:right!important;transition-duration:.5s!important;transition-property:opacity!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important;-webkit-user-select:none!important;-moz-user-select:none!important;user-select:none!important;width:var(--cbp-line-number-width,auto)!important}.wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover .line{min-height:var(--cbp-block-height,100%)!important}.wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,.wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,.wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{background:var(--cbp-line-highlight-color,rgb(14 165 233/.2))!important;left:-16px!important;min-height:var(--cbp-block-height,100%)!important;min-width:calc(var(--cbp-block-width, 100%) + 16px)!important;pointer-events:none!important;position:absolute!important;top:0!important;width:100%!important}[data-code-block-pro-font-family="Code-Pro-Comic-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Comic-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Comic-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{top:-.125rem!important}[data-code-block-pro-font-family=Code-Pro-Fira-Code].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Fira-Code].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Fira-Code].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{top:-1.5px!important}[data-code-block-pro-font-family="Code-Pro-Deja-Vu-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Deja-Vu-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Deja-Vu-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Cozette].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Cozette].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Cozette].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{top:-1px!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor).padding-disabled pre .line.cbp-line-highlight:after{left:0!important;width:100%!important}.wp-block-kevinbatdorf-code-block-pro.cbp-blur-enabled pre .line:not(.cbp-no-blur){filter:blur(1px)!important;opacity:.4!important;pointer-events:none!important;transition-duration:.2s!important;transition-property:all!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important}.wp-block-kevinbatdorf-code-block-pro.cbp-blur-enabled.cbp-unblur-on-hover:hover pre .line:not(.cbp-no-blur){--tw-blur:blur(0);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important;opacity:1!important;pointer-events:auto!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre *{font-family:inherit!important}.cbp-see-more-simple-btn-hover{transition-property:none!important}.cbp-see-more-simple-btn-hover:hover{box-shadow:inset 0 0 100px 100px hsla(0,0%,100%,.1)!important}.code-block-pro-copy-button{border:0!important;border-style:none!important;border-width:0!important;cursor:pointer!important;left:auto!important;line-height:1!important;opacity:.1!important;padding:6px!important;position:absolute!important;right:0!important;top:0!important;transition-duration:.2s!important;transition-property:opacity!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important;z-index:10!important}.code-block-pro-copy-button:focus{opacity:.4!important}.code-block-pro-copy-button:not([data-has-text-button]){background:none!important;background-color:transparent!important}.wp-block-kevinbatdorf-code-block-pro.padding-disabled .code-block-pro-copy-button{padding:0!important}.wp-block-kevinbatdorf-code-block-pro:hover .code-block-pro-copy-button{opacity:.5!important}.wp-block-kevinbatdorf-code-block-pro .code-block-pro-copy-button:hover{opacity:.9!important}.code-block-pro-copy-button[data-has-text-button],.wp-block-kevinbatdorf-code-block-pro:hover .code-block-pro-copy-button[data-has-text-button]{opacity:1!important}.wp-block-kevinbatdorf-code-block-pro .code-block-pro-copy-button[data-has-text-button]:hover{opacity:.8!important}.code-block-pro-copy-button[data-has-text-button]{border-radius:.75rem!important;display:block!important;margin-right:.75rem!important;margin-top:.7rem!important;padding:.125rem .375rem!important}.code-block-pro-copy-button[data-inside-header-type=headlightsMuted],.code-block-pro-copy-button[data-inside-header-type^=headlights]{margin-top:.85rem!important}.code-block-pro-copy-button[data-inside-header-type=headlightsMutedAlt]{margin-top:.65rem!important}.code-block-pro-copy-button[data-inside-header-type=simpleString]{margin-top:.645rem!important}.code-block-pro-copy-button[data-inside-header-type=pillString]{margin-top:1rem!important}.code-block-pro-copy-button[data-inside-header-type=pillString] .cbp-btn-text{position:relative!important;top:1px!important}.cbp-btn-text{font-size:.75rem!important;line-height:1rem!important}.code-block-pro-copy-button .without-check{display:block!important}.code-block-pro-copy-button .with-check{display:none!important}.code-block-pro-copy-button.cbp-copying{opacity:1!important}.code-block-pro-copy-button.cbp-copying .without-check{display:none!important}.code-block-pro-copy-button.cbp-copying .with-check{display:block!important}.cbp-footer-link:hover{text-decoration-line:underline!important}</style>
<style id='activitypub-followers-style-inline-css'>.activitypub-follower-block.is-style-compact .activitypub-handle,.activitypub-follower-block.is-style-compact .sep{display:none}.activitypub-follower-block.is-style-with-lines ul li{border-bottom:.5px solid;margin-bottom:.5rem;padding-bottom:.5rem}.activitypub-follower-block.is-style-with-lines ul li:last-child{border-bottom:none}.activitypub-follower-block.is-style-with-lines .activitypub-handle,.activitypub-follower-block.is-style-with-lines .activitypub-name{text-decoration:none}.activitypub-follower-block.is-style-with-lines .activitypub-handle:hover,.activitypub-follower-block.is-style-with-lines .activitypub-name:hover{text-decoration:underline}.activitypub-follower-block ul{margin:0!important;padding:0!important}.activitypub-follower-block li{display:flex;margin-bottom:1rem}.activitypub-follower-block img{border-radius:50%;height:40px;margin-right:var(--wp--preset--spacing--20,.5rem);width:40px}.activitypub-follower-block .activitypub-link{align-items:center;color:inherit!important;display:flex;flex-flow:row nowrap;max-width:100%;text-decoration:none!important}.activitypub-follower-block .activitypub-handle,.activitypub-follower-block .activitypub-name{text-decoration:underline;text-decoration-thickness:.8px;text-underline-position:under}.activitypub-follower-block .activitypub-handle:hover,.activitypub-follower-block .activitypub-name:hover{text-decoration:none}.activitypub-follower-block .activitypub-name{font-size:var(--wp--preset--font-size--normal,16px)}.activitypub-follower-block .activitypub-actor{font-size:var(--wp--preset--font-size--small,13px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.activitypub-follower-block .sep{padding:0 .2rem}.activitypub-follower-block .wp-block-query-pagination{margin-top:1.5rem}.activitypub-follower-block .activitypub-pager{cursor:default}.activitypub-follower-block .activitypub-pager.current{opacity:.33}.activitypub-follower-block .page-numbers{padding:0 .2rem}.activitypub-follower-block .page-numbers.current{font-weight:700;opacity:1}</style>
<style id='activitypub-follow-me-style-inline-css'>.activitypub-follow-me-block-wrapper{width:100%}.activitypub-follow-me-block-wrapper.has-background .activitypub-profile,.activitypub-follow-me-block-wrapper.has-border-color .activitypub-profile{padding-left:1rem;padding-right:1rem}.activitypub-follow-me-block-wrapper .activitypub-profile{align-items:center;display:flex;padding:1rem 0}.activitypub-follow-me-block-wrapper .activitypub-profile .activitypub-profile__avatar{border-radius:50%;height:75px;margin-right:1rem;width:75px}.activitypub-follow-me-block-wrapper .activitypub-profile .activitypub-profile__content{flex:1;min-width:0}.activitypub-follow-me-block-wrapper .activitypub-profile .activitypub-profile__handle,.activitypub-follow-me-block-wrapper .activitypub-profile .activitypub-profile__name{line-height:1.2;margin:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.activitypub-follow-me-block-wrapper .activitypub-profile .activitypub-profile__name{font-size:1.25em}.activitypub-follow-me-block-wrapper .activitypub-profile .activitypub-profile__follow{align-self:center;background-color:var(--wp--preset--color--black);color:var(--wp--preset--color--white);margin-left:1rem}.activitypub__modal.components-modal__frame{background-color:#f7f7f7;color:#333}.activitypub__modal.components-modal__frame .components-modal__header-heading,.activitypub__modal.components-modal__frame h4{color:#333;letter-spacing:inherit;word-spacing:inherit}.activitypub__modal.components-modal__frame .components-modal__header .components-button:hover{color:var(--wp--preset--color--white)}.activitypub__dialog{max-width:40em}.activitypub__dialog h4{line-height:1;margin:0}.activitypub__dialog .activitypub-dialog__section{margin-bottom:2em}.activitypub__dialog .activitypub-dialog__description{font-size:var(--wp--preset--font-size--normal,.75rem);margin:.33em 0 1em}.activitypub__dialog .activitypub-dialog__button-group{align-items:flex-end;display:flex;justify-content:flex-end}.activitypub__dialog .activitypub-dialog__button-group svg{height:21px;margin-right:.5em;width:21px}.activitypub__dialog .activitypub-dialog__button-group input{background-color:var(--wp--preset--color--white);border:1px solid var(--wp--preset--color--black);border-radius:inherit 0;color:var(--wp--preset--color--black);flex:1;padding:6px 12px}.activitypub__dialog .activitypub-dialog__button-group button{align-self:center;background-color:var(--wp--preset--color--black);color:var(--wp--preset--color--white);margin-left:0;text-decoration:none}</style>
<link rel="stylesheet" type="text/css" href="//wadetregaskis.com/wp-content/cache/wpfc-minified/8y9vs5e3/hrg5k.css" media="all"/>
<style id='jetpack-sharing-buttons-style-inline-css'>.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}</style>
<style id='classic-theme-styles-inline-css'>.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}</style>
<style id='global-styles-inline-css'>body{--wp--preset--color--black:#000000;--wp--preset--color--cyan-bluish-gray:#abb8c3;--wp--preset--color--white:#ffffff;--wp--preset--color--pale-pink:#f78da7;--wp--preset--color--vivid-red:#cf2e2e;--wp--preset--color--luminous-vivid-orange:#ff6900;--wp--preset--color--luminous-vivid-amber:#fcb900;--wp--preset--color--light-green-cyan:#7bdcb5;--wp--preset--color--vivid-green-cyan:#00d084;--wp--preset--color--pale-cyan-blue:#8ed1fc;--wp--preset--color--vivid-cyan-blue:#0693e3;--wp--preset--color--vivid-purple:#9b51e0;--wp--preset--color--contrast:var(--contrast);--wp--preset--color--contrast-2:var(--contrast-2);--wp--preset--color--contrast-3:var(--contrast-3);--wp--preset--color--base:var(--base);--wp--preset--color--base-2:var(--base-2);--wp--preset--color--base-3:var(--base-3);--wp--preset--color--accent:var(--accent);--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple:linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan:linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange:linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red:linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray:linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum:linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple:linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux:linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk:linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean:linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass:linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight:linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small:13px;--wp--preset--font-size--medium:20px;--wp--preset--font-size--large:36px;--wp--preset--font-size--x-large:42px;--wp--preset--spacing--20:0.44rem;--wp--preset--spacing--30:0.67rem;--wp--preset--spacing--40:1rem;--wp--preset--spacing--50:1.5rem;--wp--preset--spacing--60:2.25rem;--wp--preset--spacing--70:3.38rem;--wp--preset--spacing--80:5.06rem;--wp--preset--shadow--natural:6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep:12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp:6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined:6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp:6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap:0.5em;}:where(.is-layout-grid){gap:0.5em;}body .is-layout-flow > .alignleft{float:left;margin-inline-start:0;margin-inline-end:2em;}body .is-layout-flow > .alignright{float:right;margin-inline-start:2em;margin-inline-end:0;}body .is-layout-flow > .aligncenter{margin-left:auto !important;margin-right:auto !important;}body .is-layout-constrained > .alignleft{float:left;margin-inline-start:0;margin-inline-end:2em;}body .is-layout-constrained > .alignright{float:right;margin-inline-start:2em;margin-inline-end:0;}body .is-layout-constrained > .aligncenter{margin-left:auto !important;margin-right:auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width:var(--wp--style--global--content-size);margin-left:auto !important;margin-right:auto !important;}body .is-layout-constrained > .alignwide{max-width:var(--wp--style--global--wide-size);}body .is-layout-flex{display:flex;}body .is-layout-flex{flex-wrap:wrap;align-items:center;}body .is-layout-flex > *{margin:0;}body .is-layout-grid{display:grid;}body .is-layout-grid > *{margin:0;}:where(.wp-block-columns.is-layout-flex){gap:2em;}:where(.wp-block-columns.is-layout-grid){gap:2em;}:where(.wp-block-post-template.is-layout-flex){gap:1.25em;}:where(.wp-block-post-template.is-layout-grid){gap:1.25em;}.has-black-color{color:var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color:var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color:var(--wp--preset--color--white) !important;}.has-pale-pink-color{color:var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color:var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color:var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color:var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color:var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color:var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color:var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color:var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color:var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color:var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color:var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color:var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color:var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color:var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color:var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color:var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color:var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color:var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color:var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color:var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color:var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color:var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color:var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color:var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color:var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color:var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color:var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color:var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color:var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color:var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color:var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color:var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color:var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background:var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background:var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background:var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background:var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background:var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background:var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background:var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background:var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background:var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background:var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background:var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background:var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size:var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size:var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size:var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size:var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color:inherit;}:where(.wp-block-post-template.is-layout-flex){gap:1.25em;}:where(.wp-block-post-template.is-layout-grid){gap:1.25em;}:where(.wp-block-columns.is-layout-flex){gap:2em;}:where(.wp-block-columns.is-layout-grid){gap:2em;}
.wp-block-pullquote{font-size:1.5em;line-height:1.6;}</style>
<style>.crp_related.crp-thumbs-grid{clear:both;margin:10px 0;}.crp_related.crp-thumbs-grid h3,.crp_related.crp-thumbs-grid figure{margin:0!important;}.crp_related.crp-thumbs-grid ul{display:grid;grid-gap:10px;margin:0;justify-items:center;list-style:none;padding:0;}.crp_related.crp-thumbs-grid ul li{text-align:center;border:1px solid #ddd;display:flex;flex-direction:column;word-break:break-word;}.crp_related.crp-thumbs-grid li:hover{background:#eee;border-color:#bbb;}.crp_related.crp-thumbs-grid a:focus-visible{border:1px solid #000;border-radius:7px;}.crp_related.crp-thumbs-grid ul li a.crp_link{flex-grow:1;display:grid;overflow:hidden;padding:3px;}.crp_related.crp-thumbs-grid ul li a.crp_link .crp_thumb{grid-row-start:1;grid-row-end:3;grid-column-start:1;grid-column-end:2;}.crp_related.crp-thumbs-grid ul li a.crp_link .crp_title{display:flex;justify-content:center;align-items:center;grid-row-start:2;grid-row-end:3;grid-column-start:1;grid-column-end:2;}.crp_related.crp-thumbs-grid a{-webkit-box-shadow:none!important;-moz-box-shadow:none!important;box-shadow:none!important;text-decoration:none!important;}.crp_related.crp-thumbs-grid a:hover{text-decoration:none;}.crp_related.crp-thumbs-grid ul li img{max-width:100%;height:auto;display:block;margin:0 auto;}.crp_related.crp-thumbs-grid .crp_title{color:#fff!important;padding:3px;font-size:.9em;text-shadow:.1em .1em .2em #000;background-color:rgba(0,0,0,.5);-webkit-border-radius:7px;-moz-border-radius:7px;border-radius:7px;width:100%;overflow:hidden;line-height:initial;}.crp_related.crp-thumbs-grid li:hover .crp_title{background-color:rgba(0,0,0,.8);}.crp_related.crp-thumbs-grid li{vertical-align:bottom;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.4);-moz-box-shadow:0 1px 2px rgba(0,0,0,.4);box-shadow:0 1px 2px rgba(0,0,0,.4);-webkit-border-radius:7px;-moz-border-radius:7px;border-radius:7px;list-style-type:none;}.crp_clear{clear:both;}.crp_title:visited{color:#fff!important;}</style>
<style id='crp-style-thumbs-grid-inline-css'>.crp_related.crp-thumbs-grid ul li a.crp_link{grid-template-rows:206px auto;}
.crp_related.crp-thumbs-grid ul{grid-template-columns:repeat(auto-fill, minmax(256px, 1fr));}</style>
<link rel="stylesheet" type="text/css" href="//wadetregaskis.com/wp-content/cache/wpfc-minified/ertg0rpe/hrg5k.css" media="all"/>
<style id='generate-style-inline-css'>body{background-color:var(--base-2);color:#000;}a{color:#1e73be;}a:hover, a:focus{text-decoration:underline;}.entry-title a, .site-branding a, a.button, .wp-block-button__link, .main-navigation a{text-decoration:none;}a:hover, a:focus, a:active{color:#000000;}.wp-block-group__inner-container{max-width:1200px;margin-left:auto;margin-right:auto;}.navigation-search{position:absolute;left:-99999px;pointer-events:none;visibility:hidden;z-index:20;width:100%;top:0;transition:opacity 100ms ease-in-out;opacity:0;}.navigation-search.nav-search-active{left:0;right:0;pointer-events:auto;visibility:visible;opacity:1;}.navigation-search input[type="search"]{outline:0;border:0;vertical-align:bottom;line-height:1;opacity:0.9;width:100%;z-index:20;border-radius:0;-webkit-appearance:none;height:60px;}.navigation-search input::-ms-clear{display:none;width:0;height:0;}.navigation-search input::-ms-reveal{display:none;width:0;height:0;}.navigation-search input::-webkit-search-decoration, .navigation-search input::-webkit-search-cancel-button, .navigation-search input::-webkit-search-results-button, .navigation-search input::-webkit-search-results-decoration{display:none;}.gen-sidebar-nav .navigation-search{top:auto;bottom:0;}:root{--contrast:#222222;--contrast-2:#575760;--contrast-3:#b8b8c1;--base:#f0f0f0;--base-2:#f7f8f9;--base-3:#ffffff;--accent:#1e73be;}:root .has-contrast-color{color:var(--contrast);}:root .has-contrast-background-color{background-color:var(--contrast);}:root .has-contrast-2-color{color:var(--contrast-2);}:root .has-contrast-2-background-color{background-color:var(--contrast-2);}:root .has-contrast-3-color{color:var(--contrast-3);}:root .has-contrast-3-background-color{background-color:var(--contrast-3);}:root .has-base-color{color:var(--base);}:root .has-base-background-color{background-color:var(--base);}:root .has-base-2-color{color:var(--base-2);}:root .has-base-2-background-color{background-color:var(--base-2);}:root .has-base-3-color{color:var(--base-3);}:root .has-base-3-background-color{background-color:var(--base-3);}:root .has-accent-color{color:var(--accent);}:root .has-accent-background-color{background-color:var(--accent);}body, button, input, select, textarea{font-size:15px;}body{line-height:1.5;}p{margin-bottom:1em;}.main-title{font-size:25px;}h1{font-weight:200;font-size:30px;line-height:1;}h2{font-weight:300;font-size:25px;line-height:1;}h3{font-weight:300;font-size:20px;line-height:1;}.sidebar .widget, .footer-widgets .widget{font-size:17px;}h4{font-size:17px;}.top-bar{background-color:#636363;color:#ffffff;}.top-bar a{color:#ffffff;}.top-bar a:hover{color:#303030;}.site-header{background-color:var(--base);color:var(--base-3);}.site-header a{color:var(--accent);}.main-title a,.main-title a:hover{color:#222222;}.site-description{color:#757575;}.mobile-menu-control-wrapper .menu-toggle,.mobile-menu-control-wrapper .menu-toggle:hover,.mobile-menu-control-wrapper .menu-toggle:focus,.has-inline-mobile-toggle #site-navigation.toggled{background-color:rgba(0, 0, 0, 0.02);}.main-navigation,.main-navigation ul ul{background-color:var(--base);}.main-navigation .main-nav ul li a, .main-navigation .menu-toggle, .main-navigation .menu-bar-items{color:var(--contrast-2);}.main-navigation .main-nav ul li:not([class*="current-menu-"]):hover > a, .main-navigation .main-nav ul li:not([class*="current-menu-"]):focus > a, .main-navigation .main-nav ul li.sfHover:not([class*="current-menu-"]) > a, .main-navigation .menu-bar-item:hover > a, .main-navigation .menu-bar-item.sfHover > a{color:var(--contrast);background-color:var(--contrast-3);}button.menu-toggle:hover,button.menu-toggle:focus{color:var(--contrast-2);}.main-navigation .main-nav ul li[class*="current-menu-"] > a{color:var(--contrast-2);background-color:var(--base);}.navigation-search input[type="search"],.navigation-search input[type="search"]:active, .navigation-search input[type="search"]:focus, .main-navigation .main-nav ul li.search-item.active > a, .main-navigation .menu-bar-items .search-item.active > a{color:var(--contrast);background-color:var(--base-2);opacity:1;}.main-navigation ul ul{background-color:var(--contrast-3);}.main-navigation .main-nav ul ul li a{color:var(--base-2);}.main-navigation .main-nav ul ul li:not([class*="current-menu-"]):hover > a,.main-navigation .main-nav ul ul li:not([class*="current-menu-"]):focus > a, .main-navigation .main-nav ul ul li.sfHover:not([class*="current-menu-"]) > a{color:var(--base-2);background-color:var(--contrast-2);}.main-navigation .main-nav ul ul li[class*="current-menu-"] > a{color:var(--base-3);background-color:var(--contrast-3);}.separate-containers .inside-article, .separate-containers .comments-area, .separate-containers .page-header, .one-container .container, .separate-containers .paging-navigation, .inside-page-header{background-color:var(--base-3);}.entry-meta{color:#595959;}.entry-meta a{color:#595959;}.entry-meta a:hover{color:#1e73be;}.sidebar .widget{background-color:#ffffff;}.sidebar .widget .widget-title{color:#000000;}.footer-widgets{background-color:var(--base-2);}.footer-widgets .widget-title{color:#000000;}.site-info{color:#ffffff;background-color:var(--contrast-2);}.site-info a{color:#ffffff;}.site-info a:hover{color:#606060;}.footer-bar .widget_nav_menu .current-menu-item a{color:#606060;}input[type="text"],input[type="email"],input[type="url"],input[type="password"],input[type="search"],input[type="tel"],input[type="number"],textarea,select{color:#666666;background-color:#fafafa;border-color:#cccccc;}input[type="text"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="number"]:focus,textarea:focus,select:focus{color:#666666;background-color:#ffffff;border-color:#bfbfbf;}button,html input[type="button"],input[type="reset"],input[type="submit"],a.button,a.wp-block-button__link:not(.has-background){color:#ffffff;background-color:#666666;}button:hover,html input[type="button"]:hover,input[type="reset"]:hover,input[type="submit"]:hover,a.button:hover,button:focus,html input[type="button"]:focus,input[type="reset"]:focus,input[type="submit"]:focus,a.button:focus,a.wp-block-button__link:not(.has-background):active,a.wp-block-button__link:not(.has-background):focus,a.wp-block-button__link:not(.has-background):hover{color:#ffffff;background-color:#3f3f3f;}a.generate-back-to-top{background-color:rgba( 0,0,0,0.4 );color:#ffffff;}a.generate-back-to-top:hover,a.generate-back-to-top:focus{background-color:rgba( 0,0,0,0.6 );color:#ffffff;}:root{--gp-search-modal-bg-color:var(--base-3);--gp-search-modal-text-color:var(--contrast);--gp-search-modal-overlay-bg-color:rgba(0,0,0,0.2);}@media(max-width:768px){.main-navigation .menu-bar-item:hover > a, .main-navigation .menu-bar-item.sfHover > a{background:none;color:var(--contrast-2);}}.inside-top-bar{padding:10px;}.nav-below-header .main-navigation .inside-navigation.grid-container, .nav-above-header .main-navigation .inside-navigation.grid-container{padding:0px 20px 0px 20px;}.site-main .wp-block-group__inner-container{padding:40px;}.separate-containers .paging-navigation{padding-top:20px;padding-bottom:20px;}.entry-content .alignwide, body:not(.no-sidebar) .entry-content .alignfull{margin-left:-40px;width:calc(100% + 80px);max-width:calc(100% + 80px);}.rtl .menu-item-has-children .dropdown-menu-toggle{padding-left:20px;}.rtl .main-navigation .main-nav ul li.menu-item-has-children > a{padding-right:20px;}.inside-site-info{padding:20px;}@media(max-width:768px){.separate-containers .inside-article, .separate-containers .comments-area, .separate-containers .page-header, .separate-containers .paging-navigation, .one-container .site-content, .inside-page-header{padding:30px;}.site-main .wp-block-group__inner-container{padding:30px;}.inside-site-info{padding-right:10px;padding-left:10px;}.entry-content .alignwide, body:not(.no-sidebar) .entry-content .alignfull{margin-left:-30px;width:calc(100% + 60px);max-width:calc(100% + 60px);}.one-container .site-main .paging-navigation{margin-bottom:20px;}}
.is-right-sidebar{width:30%;}.is-left-sidebar{width:30%;}.site-content .content-area{width:100%;}@media(max-width:768px){.main-navigation .menu-toggle,.sidebar-nav-mobile:not(#sticky-placeholder){display:block;}.main-navigation ul,.gen-sidebar-nav,.main-navigation:not(.slideout-navigation):not(.toggled) .main-nav > ul,.has-inline-mobile-toggle #site-navigation .inside-navigation > *:not(.navigation-search):not(.main-nav){display:none;}.nav-align-right .inside-navigation,.nav-align-center .inside-navigation{justify-content:space-between;}}</style>
<style>.activitypub__modal.components-modal__frame{background-color:#f7f7f7;color:#333}.activitypub__modal.components-modal__frame .components-modal__header-heading,.activitypub__modal.components-modal__frame h4{color:#333;letter-spacing:inherit;word-spacing:inherit}.activitypub__modal.components-modal__frame .components-modal__header .components-button:hover{color:var(--wp--preset--color--white)}.activitypub__dialog{max-width:40em}.activitypub__dialog h4{line-height:1;margin:0}.activitypub__dialog .activitypub-dialog__section{margin-bottom:2em}.activitypub__dialog .activitypub-dialog__description{font-size:var(--wp--preset--font-size--normal,.75rem);margin:.33em 0 1em}.activitypub__dialog .activitypub-dialog__button-group{align-items:flex-end;display:flex;justify-content:flex-end}.activitypub__dialog .activitypub-dialog__button-group svg{height:21px;margin-right:.5em;width:21px}.activitypub__dialog .activitypub-dialog__button-group input{background-color:var(--wp--preset--color--white);border:1px solid var(--wp--preset--color--black);border-radius:inherit 0;color:var(--wp--preset--color--black);flex:1;padding:6px 12px}.activitypub__dialog .activitypub-dialog__button-group button{align-self:center;background-color:var(--wp--preset--color--black);color:var(--wp--preset--color--white);margin-left:0;text-decoration:none}</style>
<link rel="canonical" href="https://wadetregaskis.com/a-brief-introduction-to-type-memory-layout-in-swift/"/>
<style>.crp_related {
margin-top: 2em !important;
border-top: #ddd 1px solid;
& h4{margin-top:1em !important;}
}
.crp_related.crp-thumbs-grid {
text-align: center;
& ul {
display: flex !important;
flex-wrap: wrap;
justify-content: center;
align-items: center;
& li {
padding-top: 0px !important;
border: none;
& a.crp_link {
padding: 0;
grid-template-rows: none !important;
& figure{grid-area:1 / 1;z-index:0;}
& .crp_title{grid-area:1 / 1 !important;z-index:1;align-self:end !important;padding:0.66em 1em;color:initial !important;text-shadow:#fff 0px 0px 1px, #fff 0px 0px 2px, #fff 0px 0px 3px, #fff 0px 0px 4px, #fff 0px 0px 5px, #fff 0px 0px 6px, #fff 0px 0px 7px, #fff 0px 0px 8px, #fff 0px 0px 9px, #fff 0px 0px 10px, #fff 0px 0px 10px, #fff 0px 0px 10px, #fff 0px 0px 10px, #fff 0px 0px 10px, #fff 0px 0px 10px;background-color:rgba(0, 0, 0, 0.03) !important;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);}
& figure:has(img.crp_default_thumb){display:none !important;}
}
}
}
}</style><style>.entry-meta .byline:before, .entry-header .entry-meta span.byline:before, .entry-meta .byline:after, .entry-header .entry-meta span.byline:after, .single .byline, .group-blog .byline,
.entry-meta .byline, .entry-header .entry-meta > span.byline, .entry-meta .author.vcard{content:'';display:none;margin:0;}</style>
<style>img#wpstats{display:none}</style>
<style>.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style><link rel="icon" href="https://wadetregaskis.com/wp-content/uploads/2016/03/Stitch-512x512-1-256x256.png" sizes="32x32"/>
<link rel="icon" href="https://wadetregaskis.com/wp-content/uploads/2016/03/Stitch-512x512-1-256x256.png" sizes="192x192"/>
<link rel="apple-touch-icon" href="https://wadetregaskis.com/wp-content/uploads/2016/03/Stitch-512x512-1-256x256.png"/>
<meta name="msapplication-TileImage" content="https://wadetregaskis.com/wp-content/uploads/2016/03/Stitch-512x512-1.png"/>
<style id="wp-custom-css">.inside-header{padding:0;}
.inside-article {
padding: 2em !important;
@media only screen and (max-width: 480pt){padding:1em !important;}
& .post-image{text-align:center;}
}
@media only screen and (max-width: 900pt) {
.site-main{margin:0 !important;}
}
ul, ol {
margin-left: 2em;
&:is(.wp-block-footnotes){margin-left:0;padding-left:2em;margin-right:0;}
}
.wp-block-quote{width:fit-content;margin:1em auto 1em auto !important;padding:0.5em 1em;border:none;border-left:5px solid;border-right:5px solid;border-color:#e0e0f0;}
.wp-block-pullquote {
width: fit-content;
margin-left: auto;
margin-right: auto;
margin-bottom: 15px !important;
padding: 0;
line-height: normal;
font-size: initial;
& blockquote{margin:0;border:none;}
}
pre{font-family:ui-monospace;}
.sd-sharing{margin-top:1.25em;}
.entry-header + .post-image{margin-top:1em !important;}
div.entry-summary {
margin-top: 1em !important;
& + footer{display:none;}
}
.entry-content {
&:not(:first-child){margin-top:1em;}
& li{padding-top:1em;}
&>ul>li:first-child{padding-top:0em;}
&>ol>li:first-child{padding-top:0em;}
}
.tight:is(ol, ul) li{padding-top:0em;}
.foogallery{margin:14px;}
.site-main {
& .wp-block-group__inner-container{padding:20px;border-width:1px;border-color:#aaa;border-style:dashed;border-radius:20px;margin:20px;display:table;}
& .comments-link {
clear: both;
&:has(a[href$=\#respond]){display:none;}
}
}
.wp-block-heading{clear:both;}
h1:not(.entry-title):not(.page-title){margin-top:2.5rem;margin-bottom:10px;}
h2:not(.entry-title):not(.page-title) {
margin-top: 2rem;
margin-bottom: 10px;
&:is(:is(h1, h2, h3, h4, h5, h6) + h2){margin-top:inherit;}
}
blockquote>h2{margin-top:initial !important;}
h3:not(.entry-title):not(.page-title) {
margin-top: 2rem;
margin-bottom: 10px;
&:is(:is(h1, h2, h3, h4, h5, h6) + h3){margin-top:inherit;}
}
h4:not(.entry-title):not(.page-title) {
margin-top: 12px;
margin-bottom: 5px;
&:is(:is(h1, h2, h3, h4, h5, h6) + h4){margin-top:inherit;}
}
@media all and (min-width: 480pt) {
.ss1 {
margin-left: 1rem;
&:is(ul, ol){margin-left:calc(1rem + 2em);}
}
.ss2 {
margin-left: 2rem;
&:is(ul, ol){margin-left:calc(2rem + 2em);}
}
.ss3 {
margin-left: 3rem;
&:is(ul, ol){margin-left:calc(3rem + 2em);}
}
}
.wp-block-group__inner-container {
& h1, h2, h3, h4, h5, h6{margin-top:0px;}
& p:last-of-type{margin-bottom:0;}
}
.has-drop-cap:not(:focus):first-letter{margin:.1em .01em .1em -.1em}
.comment-content{padding:1em;}
.comment > ul{margin-left:.75em;padding-left:1em !important;padding-bottom:0em;}
.comment-body{margin-top:1em;padding-top:1em;padding-bottom:1em;}
.featured-image > img{margin-left:auto;margin-right:auto;display:block;}
#toc_container{float:right;margin-left:20pt;}:not(.comment-author) > cite{text-align:right;display:block;font-size:80%;font-style:initial;}
nav.main-navigation {
& a{line-height:3em !important;}
& .inside-navigation {
display: flex;
& .menu-toggle{order:0;}
& .main-nav{order:1;}
& .navigation-search{transition:opacity 200ms ease-in-out;}
& .nav-search-active {
position: initial;
width: calc(min(100%, 250pt));
@media(max-width:768px){width:calc(100% - 0.5em);position:absolute;top:0.25em;left:0.25em;}
left: initial;
right: initial;
order: 2;
& .search-field {
height: 2.5em;
padding-top: 0pt;
padding-bottom: 0pt;
padding-right: 2.75em;
@media(min-width:768px){padding-right:2.15em;}
background-color: white;
border-radius: 50pt;
border: solid 1pt var(--contrast-3);
}
}
& .menu-bar-items {
order: 3;
& .close-search {				
@media(min-width:768px){left:-3.15em;}
& a{background-color:transparent;}
}
}
}
& ul ul{width:100%;text-indent:0.5em;}
}
button.menu-toggle{line-height:2em;}
.sub-menu > li > a{padding-top:0 !important;padding-bottom:0 !important;padding-left:10pt !important;}
header.page-header{padding:2em !important;background-color:transparent !important;margin-bottom:0;}
.entry-content > [class*="wp-block-"]:not(:last-child):not(.wp-block-heading){margin-bottom:1em;}
ul + .wp-block-image, ol + .wp-block-image{margin-top:-0.5em;}
.wp-block-image {
margin-top: 1em;
margin-bottom: 1em;
&:has(figcaption){margin-top:2em;}
&:has(.alignleft){margin-top:0;margin-bottom:0 !important;}
&:has(.alignright){margin-top:0;margin-bottom:0;}
& .alignleft{margin-top:0;margin-bottom:0;}
& .alignright{margin-top:0;margin-bottom:0;}
}
.wp-block-group__inner-container {
& :first-child{margin-top:0;}
& :last-child{margin-bottom:0;}
}
.wp-block-preformatted{margin-left:auto;margin-right:auto;max-width:fit-content;}
code, kbd, tt, var{font-family:"SF Mono", SFMono-Regular, ui-monospace, monospace;font-size:inherit;font-weight:inherit;font-style:inherit;}
.has-large-font-size {
margin-bottom: 15px;
& code{font-size:revert;}
}
.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre code{white-space:pre-wrap !important;}
div.wp-block-kevinbatdorf-code-block-pro {
font-family: "SF Mono", SFMono-Regular, ui-monospace, monospace;
width: fit-content;
margin: 1em auto;
border: 0.5px var(--contrast-3);
border-style: solid;
padding: 0.75em 1em;
border-radius: 1.25em;
box-shadow: #0001 0 0 20px;
clear: both;
& .line{overflow-wrap:anywhere;}
& span[style*=\#0000FF], span[style*=\#AF00DB]{
font-weight:675;color:#9B2393 !important;}
& span[style*=\#008000], span[style*=\#81f179]{
font-family:system-ui !important;font-style:italic;}
& span[style*=\#008000]{
color:#5D6C79 !important;}
& span[style*=\#001080]{
color:#3E8087 !important;}
& span[style*=\#795E26]{
color:#804FB8 !important;}
& span[style*=\#267F99]{
color:#4B22B0 !important;}
& span[style*=\#A31515]{
font-weight:500;color:#D12F1B !important;}
& span[style*=\#098658]{
font-weight:500;color:#272AD8 !important;}
}
div.footer-bar {	
& .wp-block-column{flex-basis:content !important;}
& .wp-block-column.is-vertically-aligned-center{align-self:stretch;}
& p{margin-bottom:0 !important;}
& div.wp-block-columns{gap:1.5em !important;margin-bottom:0;}
}
footer.entry-meta {
margin-top: 0;
display: flex;
column-gap: 1em;
row-gap: 0.4em;
flex-wrap: wrap;
justify-content: center;
text-align: center;
row-gap: 1em;
& a{line-height:1.5;}
& .comments-link{flex-basis:-webkit-fill-available;}
& .post-navigation {
flex-basis: -webkit-fill-available;
display: flex;
column-gap: 1em;
row-gap: 0.5em;
justify-content: space-between;
flex-wrap: wrap;
& .nav-previous{text-align:left;display:flex;}
& .nav-next {
text-align: right;
display: flex;
& .next{order:1;}
& .gp-icon{order:2;margin-left:0.6em;margin-right:0;}
}
}
}
div.sd-content ul {
display: flex;
flex-flow: wrap;
gap: 1em;
justify-content: center;
& li{margin:0;white-space:nowrap;}
& .share-end{width:100%;}
}
.wp-block-footnotes {
border-top: #ddd 1px solid;
margin-top: 3em;
&::before{content:"Footnotes";text-align:center;margin-left:-2em;display:block;font-size:17px;margin-top:1em;margin-bottom:0.5em;}
}
.site-main div.post-image .wp-post-image{max-height:400pt;width:auto;}
div.metaslider{margin-bottom:1em !important;}
div.pdf-iframe-a4 {
position: relative;
overflow: hidden;
width: 100%;
padding-top: 141.43145161%;
margin-top: 1em;
margin-bottom: 1em;
& > iframe{position:absolute;left:0;top:0;right:0;bottom:0;width:100%;height:100%;}
& ~ figcaption{text-align:center;margin-bottom:1em;margin-top:-0.5em;font-size:13px;}
}
form.comment-form {
& #author, #email, #url{width:100%;}
& .comment-form-cookies-consent, .comment-subscription-form {
margin: 0.5em 0;
display: block;
& input{margin:0 0.2em 0 0;}
}
& .form-submit{margin-top:1em;}
}
table {
margin-bottom: 0;
& thead{background-color:#f5f5ff;border-bottom-width:1px !important;}
& thead, th, td{border-color:var(--contrast-3) !important;}
& tr:nth-child(even) td{background-color:#fafafa;}
}</style>
</head>
<body data-rsssl=1 class="post-template-default single single-post postid-7803 single-format-standard wp-embed-responsive no-sidebar nav-above-header separate-containers nav-search-enabled nav-aligned-center header-aligned-center dropdown-hover" itemtype="https://schema.org/Blog" itemscope>
<a class="screen-reader-text skip-link" href="#content" title="Skip to content">Skip to content</a>		<nav class="main-navigation nav-align-center has-menu-bar-items sub-menu-right" id="site-navigation" aria-label="Primary" itemtype="https://schema.org/SiteNavigationElement" itemscope>
<div class="inside-navigation">
<form method="get" class="search-form navigation-search" action="https://wadetregaskis.com/">
<input type="search" class="search-field" value="" name="s" title="Search" />
</form>				<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="gp-icon icon-menu-bars"><svg viewBox="0 0 512 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"><path d="M0 96c0-13.255 10.745-24 24-24h464c13.255 0 24 10.745 24 24s-10.745 24-24 24H24c-13.255 0-24-10.745-24-24zm0 160c0-13.255 10.745-24 24-24h464c13.255 0 24 10.745 24 24s-10.745 24-24 24H24c-13.255 0-24-10.745-24-24zm0 160c0-13.255 10.745-24 24-24h464c13.255 0 24 10.745 24 24s-10.745 24-24 24H24c-13.255 0-24-10.745-24-24z" /></svg><svg viewBox="0 0 512 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"><path d="M71.029 71.029c9.373-9.372 24.569-9.372 33.942 0L256 222.059l151.029-151.03c9.373-9.372 24.569-9.372 33.942 0 9.372 9.373 9.372 24.569 0 33.942L289.941 256l151.03 151.029c9.372 9.373 9.372 24.569 0 33.942-9.373 9.372-24.569 9.372-33.942 0L256 289.941l-151.029 151.03c-9.373 9.372-24.569 9.372-33.942 0-9.372-9.373-9.372-24.569 0-33.942L222.059 256 71.029 104.971c-9.372-9.373-9.372-24.569 0-33.942z" /></svg></span><span class="mobile-menu">Menu</span>				</button>
<div id="primary-menu" class="main-nav"><ul id="menu-primary-menu" class="menu sf-menu"><li id="menu-item-4717" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-4717"><a href="https://wadetregaskis.com" data-wpel-link="internal">Home</a></li> <li id="menu-item-4743" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-4743"><a>Categories<span role="presentation" class="dropdown-menu-toggle"><span class="gp-icon icon-arrow"><svg viewBox="0 0 330 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"><path d="M305.913 197.085c0 2.266-1.133 4.815-2.833 6.514L171.087 335.593c-1.7 1.7-4.249 2.832-6.515 2.832s-4.815-1.133-6.515-2.832L26.064 203.599c-1.7-1.7-2.832-4.248-2.832-6.514s1.132-4.816 2.832-6.515l14.162-14.163c1.7-1.699 3.966-2.832 6.515-2.832 2.266 0 4.815 1.133 6.515 2.832l111.316 111.317 111.316-111.317c1.7-1.699 4.249-2.832 6.515-2.832s4.815 1.133 6.515 2.832l14.162 14.163c1.7 1.7 2.833 4.249 2.833 6.515z" /></svg></span></span></a> <ul class="sub-menu"> <li id="menu-item-4751" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-4751"><a href="https://wadetregaskis.com/categories/coding/" data-wpel-link="internal">Coding</a></li> <li id="menu-item-4762" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4762"><a href="https://wadetregaskis.com/categories/creative/" data-wpel-link="internal">Creative</a></li> <li id="menu-item-4744" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4744"><a href="https://wadetregaskis.com/categories/education/" data-wpel-link="internal">Education</a></li> <li id="menu-item-4766" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4766"><a href="https://wadetregaskis.com/categories/howto/" data-wpel-link="internal">Howto</a></li> <li id="menu-item-4764" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4764"><a href="https://wadetregaskis.com/categories/ideas/" data-wpel-link="internal">Ideas</a></li> <li id="menu-item-4763" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4763"><a href="https://wadetregaskis.com/categories/meta/" data-wpel-link="internal">Meta</a></li> <li id="menu-item-4755" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4755"><a href="https://wadetregaskis.com/categories/news/" data-wpel-link="internal">News</a></li> <li id="menu-item-4753" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4753"><a href="https://wadetregaskis.com/categories/photography/" data-wpel-link="internal">Photography</a></li> <li id="menu-item-4749" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4749"><a href="https://wadetregaskis.com/categories/ramblings/" data-wpel-link="internal">Ramblings</a></li> <li id="menu-item-4761" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4761"><a href="https://wadetregaskis.com/categories/reviews/" data-wpel-link="internal">Reviews</a></li> <li id="menu-item-4767" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4767"><a href="https://wadetregaskis.com/categories/theories/" data-wpel-link="internal">Theories</a></li> <li id="menu-item-4752" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4752"><a href="https://wadetregaskis.com/categories/travels/" data-wpel-link="internal">Travels</a></li> </ul> </li> <li id="menu-item-5804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5804"><a target="_blank" rel="me external noopener" href="https://www.flickr.com/photos/wadetregaskis/" data-wpel-link="external">Photos</a></li> </ul></div><div class="menu-bar-items"><span class="menu-bar-item search-item"><a aria-label="Open Search Bar" href="#"><span class="gp-icon icon-search"><svg viewBox="0 0 512 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"><path fill-rule="evenodd" clip-rule="evenodd" d="M208 48c-88.366 0-160 71.634-160 160s71.634 160 160 160 160-71.634 160-160S296.366 48 208 48zM0 208C0 93.125 93.125 0 208 0s208 93.125 208 208c0 48.741-16.765 93.566-44.843 129.024l133.826 134.018c9.366 9.379 9.355 24.575-.025 33.941-9.379 9.366-24.575 9.355-33.941-.025L337.238 370.987C301.747 399.167 256.839 416 208 416 93.125 416 0 322.875 0 208z" /></svg><svg viewBox="0 0 512 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"><path d="M71.029 71.029c9.373-9.372 24.569-9.372 33.942 0L256 222.059l151.029-151.03c9.373-9.372 24.569-9.372 33.942 0 9.372 9.373 9.372 24.569 0 33.942L289.941 256l151.03 151.029c9.372 9.373 9.372 24.569 0 33.942-9.373 9.372-24.569 9.372-33.942 0L256 289.941l-151.029 151.03c-9.373 9.372-24.569 9.372-33.942 0-9.372-9.373-9.372-24.569 0-33.942L222.059 256 71.029 104.971c-9.372-9.373-9.372-24.569 0-33.942z" /></svg></span></a></span></div></div></nav>
<header class="site-header grid-container" id="masthead" aria-label="Site" itemtype="https://schema.org/WPHeader" itemscope>
<div class="inside-header grid-container"></div></header>
<div class="site grid-container container hfeed" id="page">
<div class="site-content" id="content">
<div class="content-area" id="primary">
<main class="site-main" id="main">
<article id="post-7803" class="post-7803 post type-post status-publish format-standard hentry category-coding tag-alignment tag-memory-efficiency tag-memory-layout tag-padding tag-swift" itemtype="https://schema.org/CreativeWork" itemscope>
<div class="inside-article">
<header class="entry-header">
<h1 class="entry-title" itemprop="headline">A brief introduction to type memory layout in Swift</h1>		<div class="entry-meta"> <span class="posted-on"><time class="entry-date published" datetime="2024-02-27T21:18:44-08:00" itemprop="datePublished">February 27, 2024</time></span> <span class="byline">by <span class="author vcard" itemprop="author" itemtype="https://schema.org/Person" itemscope><a class="url fn n" href="#" title="View all posts by" rel="author" itemprop="url"><span class="author-name" itemprop="name"></span></a></span></span></div></header>
<div class="entry-content" itemprop="text">
<div id="toc_container" class="no_bullets"><p class="toc_title">Contents</p><ul class="toc_list"><li><a href="#Determining_how_Swift_lays_out_a_type">Determining how Swift lays out a type</a></li><li><a href="#Scalars_tend_to_be_pleasantly_boring">Scalars tend to be pleasantly boring</a></li><li><a href="#Characters_are_expensive">Characters are expensive</a></li><li><a href="#How_types_compose_into_structs_classes_and_actors">How types compose into structs, classes, and actors</a><ul><li><a href="#Contiguous_Size_depends_on_stored_property_order">Contiguous Size depends on stored property order</a><ul><li><a href="#Trailing_padding_is_better_than_internal_padding">Trailing padding is better than internal padding</a></li></ul></li><li><a href="#Actual_Size_Stride_also_depends_on_stored_property_order">Actual Size (Stride) also depends on stored property order</a></li><li><a href="#Bools_are_bytes_not_bits">Bools are bytes, not bits</a></li><li><a href="#except_when_they8217re_not">except when they&#8217;re not</a></li></ul></li><li><a href="#Appendices">Appendices</a><ul><li><a href="#Helper_functions">Helper functions</a></li></ul></li></ul></div><p>Most of the time we Swift programmers don&#8217;t really think about how our types &#8211; structs, classes, actors, enums, etc &#8211; are represented in memory.  We just deal with them abstractly, knowing that somehow the compiler boils them down to a bunch of bytes, handling all the complexity of wrangling those bytes for us.</p>
<p>However, whether we realise it or not, we humans do actually determine how our types are laid out in memory, and how much memory they use &#8211; and in more subtle ways than you might realise.  We can have a significant impact on how <em>efficient</em> our memory usage is &#8211; and consequently runtime performance &#8211; based on things as innocuous as in what order we declare stored properties.</p>
<p>I&#8217;m going to start at the beginning, but if you find the foundations &amp; theory uninteresting, at least read the subsequent section headings for the key takeaways.</p>
<h1 class="wp-block-heading"><span id="Determining_how_Swift_lays_out_a_type">Determining how Swift lays out a type</span></h1>
<p>The Swift standard library includes a handy utility, <code><a href="https://developer.apple.com/documentation/swift/memorylayout" data-wpel-link="external" target="_blank" rel="external noopener">MemoryLayout</a></code>.  It reports three attributes regarding how a target type is actually laid out in memory by the compiler:</p>
<ul>
<li>&#8220;<strong>Size</strong>&#8221; &#8211; the number of <em>contiguous</em> bytes required to store an instance of the type. This is not necessarily the <em>optimal</em> size (as we&#8217;ll see later) nor the <em>actual</em> size, so it&#8217;s not terribly useful other than as a way to infer other, more interesting attributes.</li>
<li><strong>Stride</strong> &#8211; the <em>actual</em> number of bytes required to store an instance of the type<sup data-fn="13cd788d-5855-4a1e-a1bd-5d8bf2c204ed" class="fn"><a href="#13cd788d-5855-4a1e-a1bd-5d8bf2c204ed" id="13cd788d-5855-4a1e-a1bd-5d8bf2c204ed-link">1</a></sup>, taking into account its alignment requirements.</li>
<li><strong>Alignment</strong> &#8211; the address of any instance of the type must be evenly divisible by this power of two.<br><br>Alignment is a tricky concept and pivotal to how &amp; why data types are laid out the way they are (not just in Swift, but in practically all programming languages). Thankfully, you don&#8217;t really need to understand alignment for the purposes of this post &#8211; just consider it a &#8220;magic&#8221; number dictated by hardware and compilers for performance and portability. Or see e.g. <a href="https://en.wikipedia.org/wiki/Data_structure_alignment" data-wpel-link="external" target="_blank" rel="external noopener">Wikipedia</a> if you really want to dig into it.</li>
</ul>
<p>Using <code><a href="https://developer.apple.com/documentation/swift/mirror" data-wpel-link="external" target="_blank" rel="external noopener">Mirror</a></code>, it&#8217;s also possible to sum up the size of the stored properties for structs, classes, etc.  That tells you the <em>nominal</em> size, if alignment weren&#8217;t an issue.</p>
<p>The difference between the <em>nominal</em> <em>size</em> and <em>stride</em> (if any) is the <em>padding</em>.  Padding bytes aren&#8217;t actually used to store anything.  They are wasted space.  Minimising padding is generally good, especially if doing so doesn&#8217;t require breaking any alignment requirements.  Padding can be internal (between stored properties within the type) or trailing (after all stored properties within the type) &#8211; we&#8217;ll dig into the practical difference later.</p>
<p>So, armed will this knowledge and tools, let&#8217;s interrogate some types.</p>
<h1 class="wp-block-heading"><span id="Scalars_tend_to_be_pleasantly_boring">Scalars tend to be pleasantly boring</span></h1>
<p>In general, scalars &#8211; individual numbers &amp; booleans &#8211; tend to have no padding and be aligned to their full size (known as <em>natural</em> alignment).  e.g.:</p>
<figure class="wp-block-table aligncenter"><table><thead><tr><th class="has-text-align-right" data-align="right">Type</th><th class="has-text-align-center" data-align="center">Nominal Size</th><th class="has-text-align-center" data-align="center">Contiguous Size</th><th class="has-text-align-center" data-align="center">Alignment</th><th class="has-text-align-center" data-align="center">Actual Size (Stride)</th><th class="has-text-align-center" data-align="center">Internal Padding</th><th class="has-text-align-center" data-align="center">Trailing Padding</th></tr></thead><tbody><tr><td class="has-text-align-right" data-align="right">Bool</td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">0</td><td class="has-text-align-center" data-align="center">0</td></tr><tr><td class="has-text-align-right" data-align="right">Int8 / UInt8</td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">0</td><td class="has-text-align-center" data-align="center">0</td></tr><tr><td class="has-text-align-right" data-align="right">Int16 / UInt16</td><td class="has-text-align-center" data-align="center">2</td><td class="has-text-align-center" data-align="center">2</td><td class="has-text-align-center" data-align="center">2</td><td class="has-text-align-center" data-align="center">2</td><td class="has-text-align-center" data-align="center">0</td><td class="has-text-align-center" data-align="center">0</td></tr><tr><td class="has-text-align-right" data-align="right">Int32 / UInt32</td><td class="has-text-align-center" data-align="center">4</td><td class="has-text-align-center" data-align="center">4</td><td class="has-text-align-center" data-align="center">4</td><td class="has-text-align-center" data-align="center">4</td><td class="has-text-align-center" data-align="center">0</td><td class="has-text-align-center" data-align="center">0</td></tr><tr><td class="has-text-align-right" data-align="right">Int64 / UInt64</td><td class="has-text-align-center" data-align="center">8</td><td class="has-text-align-center" data-align="center">8</td><td class="has-text-align-center" data-align="center">8</td><td class="has-text-align-center" data-align="center">8</td><td class="has-text-align-center" data-align="center">0</td><td class="has-text-align-center" data-align="center">0</td></tr><tr><td class="has-text-align-right" data-align="right">Float</td><td class="has-text-align-center" data-align="center">4</td><td class="has-text-align-center" data-align="center">4</td><td class="has-text-align-center" data-align="center">4</td><td class="has-text-align-center" data-align="center">4</td><td class="has-text-align-center" data-align="center">0</td><td class="has-text-align-center" data-align="center">0</td></tr><tr><td class="has-text-align-right" data-align="right">Double</td><td class="has-text-align-center" data-align="center">8</td><td class="has-text-align-center" data-align="center">8</td><td class="has-text-align-center" data-align="center">8</td><td class="has-text-align-center" data-align="center">8</td><td class="has-text-align-center" data-align="center">0</td><td class="has-text-align-center" data-align="center">0</td></tr></tbody></table></figure>
<div class="wp-block-group is-layout-constrained wp-block-group-is-layout-constrained"><div class="wp-block-group__inner-container">
<p>  <code>Int</code> &amp; <code>UInt</code> vary in size across CPU ISAs, following the natural word size.  So, on 64-bit ISAs they are equivalent to <code>Int64</code> / <code>UInt64</code>, while on 32-bit ISAs they are equivalent to <code>Int32</code> / <code>UInt32</code>.</p></div></div><h1 class="wp-block-heading"><span id="Characters_are_expensive">Characters are expensive</span></h1>
<p><code><a href="https://developer.apple.com/documentation/swift/string" data-wpel-link="external" target="_blank" rel="external noopener">String</a></code> is a surprisingly and extremely complicated type, which is largely a topic for another time.  However, one important thing to note is its relationship to <code><a href="https://developer.apple.com/documentation/swift/character" data-wpel-link="external" target="_blank" rel="external noopener">Character</a></code>:</p>
<figure class="wp-block-table aligncenter"><table><thead><tr><th class="has-text-align-right" data-align="right">Type</th><th class="has-text-align-center" data-align="center">Nominal Size</th><th class="has-text-align-center" data-align="center">Contiguous Size</th><th class="has-text-align-center" data-align="center">Alignment</th><th class="has-text-align-center" data-align="center">Actual Size (Stride)</th><th class="has-text-align-center" data-align="center">Internal Padding</th><th class="has-text-align-center" data-align="center">Trailing Padding</th></tr></thead><tbody><tr><td class="has-text-align-right" data-align="right">Character</td><td class="has-text-align-center" data-align="center">16</td><td class="has-text-align-center" data-align="center">16</td><td class="has-text-align-center" data-align="center">8</td><td class="has-text-align-center" data-align="center">16</td><td class="has-text-align-center" data-align="center">0</td><td class="has-text-align-center" data-align="center">0</td></tr><tr><td class="has-text-align-right" data-align="right">String</td><td class="has-text-align-center" data-align="center">16</td><td class="has-text-align-center" data-align="center">16</td><td class="has-text-align-center" data-align="center">8</td><td class="has-text-align-center" data-align="center">16</td><td class="has-text-align-center" data-align="center">0</td><td class="has-text-align-center" data-align="center">0</td></tr></tbody></table></figure>
<p>They&#8217;re the same!  <code>Character</code> is a lie &#8211; <a href="https://github.com/apple/swift/blob/bd46860dfbaa1471c6210595f4291873a49676f3/stdlib/public/core/Character.swift#L67" data-wpel-link="external" target="_blank" rel="external noopener">it&#8217;s actually a <code>String</code></a>!</p>
<p>There is of course more to <code>Character</code> &#8211; although it <em>is</em> a string under the covers, its API enforces that it can only ever contain a <em>single</em> character.  But that&#8217;s about it.</p>
<p>The reason is that a single character has no upper bound on its byte size &#8211; these are Unicode characters (formally known as <em><a href="https://www.unicode.org/reports/tr29/" data-wpel-link="external" target="_blank" rel="external noopener">extended grapheme clusters</a></em>), not ASCII characters that fit trivially into a single byte.  Unicode characters can be composed of <em>multiple</em> Unicode scalars (a naive notion of a Unicode &#8216;character&#8217;, that is Unicode&#8217;s basic building block) &#8211; and that&#8217;s just scratching the surface.  <a href="https://andybargh.com/about/" data-wpel-link="external" target="_blank" rel="external noopener">Andy Bargh</a> has written <a href="https://andybargh.com/unicode/" data-wpel-link="external" target="_blank" rel="external noopener">a nice Swift-centric introduction to the fun of Unicode</a>, if you want to pull on that thread.</p>
<p>So, rather than reimplementing a <em>tremendous</em> amount of complex functionality, <code>Character</code> just uses <code>String</code> to do its dirty work.  It&#8217;s smart, but it means that <code>Character</code>s are as expensive as <code>String</code>s<sup data-fn="a966f782-5d20-411c-a04b-7b82986b6617" class="fn"><a href="#a966f782-5d20-411c-a04b-7b82986b6617" id="a966f782-5d20-411c-a04b-7b82986b6617-link">2</a></sup>.</p>
<p>Swift has no direct equivalent to the <code>char</code> type that many other languages have (i.e. an ASCII character; a byte).  The closest thing is <code>UInt8</code> (which is why you&#8217;ll often see <code>[UInt8]</code> or <code>UnsafeMutableBufferPointer&lt;UInt8></code> or similar when dealing with raw memory or C/C++ APIs).</p>
<p>The takeaway is:  don&#8217;t treat <code>Character</code> like <code>char</code>.  They are very different.  <code>Character</code> is much more expensive, in both memory and CPU usage.</p>
<div class="wp-block-group is-layout-constrained wp-block-group-is-layout-constrained"><div class="wp-block-group__inner-container">
<p> Note that the quoted size of 16 bytes is <em>not</em> necessarily the full size of a <code>Character</code> or <code>String</code>.  That includes a <em>small</em> subsection available for storing the actual string data, if that data happens to be very small.  If it&#8217;s not, then <code>String</code> makes a <em>separate</em> memory allocation for it.  That second allocation is always <em>at least</em> 16 bytes too.</p>
<p>The situation is even more complicated for <code>NSString</code>s bridged from Objective-C.</p></div></div><h1 class="wp-block-heading"><span id="How_types_compose_into_structs_classes_and_actors">How types compose into structs, classes, and actors</span></h1>
<p><em>Generally</em>, the rules are:</p>
<ul>
<li><em>Alignment</em> is the greatest of the components&#8217; alignments.</li>
<li><em>Stride</em> is the [contiguous] size padded up &#8211; if necessary &#8211; to satisfy the alignment.</li>
<li><em>Size</em> is complicated. </li>
</ul>
<p>Let&#8217;s start with a simple example:</p>
<div class="wp-block-kevinbatdorf-code-block-pro padding-disabled" data-code-block-pro-font-family="" style="font-size:.875rem;line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code><span class="line"><span style="color: #0000FF">struct</span><span style="color: #000000"> </span><span style="color: #267F99">Composite</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> a: </span><span style="color: #267F99">Int64</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> b: </span><span style="color: #267F99">Int32</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><p>This <code>Composite</code> struct has a <em>nominal</em> size of twelve bytes &#8211; just the sum of its components.</p>
<p>Its components have alignment requirements of eight and four, respectively.  The greatest of those is eight, so that is the overall struct&#8217;s alignment.</p>
<p>Twelve is not a multiple of eight, so four bytes of padding are added to fix that, making the stride (the effective size) sixteen bytes.</p>
<p>But what happens if we change the order of the stored properties?</p>
<h2 class="wp-block-heading"><span id="Contiguous_Size_depends_on_stored_property_order">Contiguous Size depends on stored property order</span></h2>
<div class="wp-block-kevinbatdorf-code-block-pro padding-disabled" data-code-block-pro-font-family="" style="font-size:.875rem;line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code><span class="line"><span style="color: #0000FF">struct</span><span style="color: #000000"> </span><span style="color: #267F99">CompositeB</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> b: </span><span style="color: #267F99">Int32</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> a: </span><span style="color: #267F99">Int64</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><p>You might think this has no effect &#8211; after all, the struct is still storing the same things; what difference does the order make?</p>
<figure class="wp-block-table aligncenter"><table><thead><tr><th class="has-text-align-right" data-align="right">Type</th><th class="has-text-align-center" data-align="center">Nominal Size</th><th class="has-text-align-center" data-align="center">Contiguous Size</th><th class="has-text-align-center" data-align="center">Alignment</th><th class="has-text-align-center" data-align="center">Actual Size (Stride)</th><th class="has-text-align-center" data-align="center">Internal Padding</th><th class="has-text-align-center" data-align="center">Trailing Padding</th></tr></thead><tbody><tr><td class="has-text-align-right" data-align="right">Composite</td><td class="has-text-align-center" data-align="center">12</td><td class="has-text-align-center" data-align="center">12</td><td class="has-text-align-center" data-align="center">8</td><td class="has-text-align-center" data-align="center">16</td><td class="has-text-align-center" data-align="center">0</td><td class="has-text-align-center" data-align="center">4</td></tr><tr><td class="has-text-align-right" data-align="right">CompositeB</td><td class="has-text-align-center" data-align="center">12</td><td class="has-text-align-center" data-align="center">16</td><td class="has-text-align-center" data-align="center">8</td><td class="has-text-align-center" data-align="center">16</td><td class="has-text-align-center" data-align="center">4</td><td class="has-text-align-center" data-align="center">0</td></tr></tbody></table></figure>
<p>For better or worse, Swift uses declaration order for the in-memory order of stored properties<sup data-fn="06c81bdc-8a1d-45ef-ba68-206050b9acd3" class="fn"><a href="#06c81bdc-8a1d-45ef-ba68-206050b9acd3" id="06c81bdc-8a1d-45ef-ba68-206050b9acd3-link">3</a></sup>.  And that can influence where padding goes.</p>
<p>In the case of our modified struct, <code>CompositeB</code>, the memory layout procedure is basically:</p>
<ol>
<li>Place the first item.  That&#8217;s an <code>Int32</code>, so it takes four bytes.  It requires four byte alignment, so the struct now requires [at least] four byte alignment.</li>
<li>Place the second item.  That&#8217;s an <code>Int64</code>.  It takes eight bytes.  It requires <em>eight</em> byte alignment.  So it cannot be placed immediately after the first item, as that would be an offset of and therefore alignment of four, which is not a multiple of eight.  So four bytes of padding are added, in-between the two items.<br><br>And the alignment requirement of the overall struct bumps up to eight, as well.</li>
</ol>
<p>The net result is that while the effective size is unchanged (at sixteen bytes), the Contiguous Size <em>has</em> changed &#8211; before it was technically just twelve bytes, but now it&#8217;s the full sixteen.  There&#8217;s still four bytes of padding in there that technically don&#8217;t matter and aren&#8217;t used, but because they&#8217;re now in the middle instead of at the end, they&#8217;re harder for the compiler to ignore.</p>
<h3 class="wp-block-heading"><span id="Trailing_padding_is_better_than_internal_padding">Trailing padding is better than internal padding</span></h3>
<p>In this specific example, this change doesn&#8217;t really matter.  The code generated for copying the struct will probably just use two load and two store instructions anyway, one for each stored property, so it doesn&#8217;t really matter where the padding is.  However, if the struct were bigger &#8211; more and/or larger stored properties &#8211; then copy might be implement as a call to <code>memcpy</code><sup data-fn="7bdf4f15-e127-4de0-9256-abf550dbb5b0" class="fn"><a href="#7bdf4f15-e127-4de0-9256-abf550dbb5b0" id="7bdf4f15-e127-4de0-9256-abf550dbb5b0-link">4</a></sup>.  That call won&#8217;t bother including any <em>trailing</em> padding because that&#8217;s easy to omit &#8211; just stop copying early &#8211; but it&#8217;ll have to copy the <em>internal</em> padding bytes even though their contents are irrelevant.  So it wastes time.</p>
<p>How <em>often</em> this manifests as a noticeable performance difference is much harder to say.  Probably you shouldn&#8217;t stress too much about this.  However, that doesn&#8217;t mean you can ignore stored property ordering, because</p>
<h2 class="wp-block-heading"><span id="Actual_Size_Stride_also_depends_on_stored_property_order">Actual Size (Stride) also depends on stored property order</span></h2>
<div class="wp-block-kevinbatdorf-code-block-pro padding-disabled" data-code-block-pro-font-family="" style="font-size:.875rem;line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code><span class="line"><span style="color: #0000FF">struct</span><span style="color: #000000"> </span><span style="color: #267F99">Composite2</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> a: </span><span style="color: #267F99">Int64</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> b: </span><span style="color: #267F99">Int32</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> c: </span><span style="color: #267F99">Int32</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #0000FF">struct</span><span style="color: #000000"> </span><span style="color: #267F99">Composite2B</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> b: </span><span style="color: #267F99">Int32</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> a: </span><span style="color: #267F99">Int64</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> c: </span><span style="color: #267F99">Int32</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><figure class="wp-block-table aligncenter"><table><thead><tr><th class="has-text-align-right" data-align="right">Type</th><th class="has-text-align-center" data-align="center">Nominal Size</th><th class="has-text-align-center" data-align="center">Contiguous Size</th><th class="has-text-align-center" data-align="center">Alignment</th><th class="has-text-align-center" data-align="center">Actual Size (Stride)</th><th class="has-text-align-center" data-align="center">Internal Padding</th><th class="has-text-align-center" data-align="center">Trailing Padding</th></tr></thead><tbody><tr><td class="has-text-align-right" data-align="right">Composite2</td><td class="has-text-align-center" data-align="center">16</td><td class="has-text-align-center" data-align="center">16</td><td class="has-text-align-center" data-align="center">8</td><td class="has-text-align-center" data-align="center">16</td><td class="has-text-align-center" data-align="center">0</td><td class="has-text-align-center" data-align="center">0</td></tr><tr><td class="has-text-align-right" data-align="right">Composite2B</td><td class="has-text-align-center" data-align="center">16</td><td class="has-text-align-center" data-align="center">20</td><td class="has-text-align-center" data-align="center">8</td><td class="has-text-align-center" data-align="center">24</td><td class="has-text-align-center" data-align="center">4</td><td class="has-text-align-center" data-align="center">4</td></tr></tbody></table></figure>
<p>Oh no!  Storing the exact same data in the &#8216;wrong&#8217; order has increased the actual memory usage by 50%!</p>
<p>It&#8217;s the same reason as for the simpler case covered earlier &#8211; every individual stored property must be stored with correct alignment, which means you can&#8217;t put an <code>Int64</code> immediately after a single <code>Int32</code>.  Having to put four bytes of padding in-between means your overall size (twenty bytes) isn&#8217;t a multiple of the overall alignment requirement (eight) so <em>another</em> four bytes of padding have to be added at the end.</p>
<p>Now, this doesn&#8217;t <em>always</em> matter.  If you only have a handful of instances of <code>Composite2B</code> in your program at any one time, the wasted memory will be insignificant.  But if you have many then it can add up to a significant cost.  So be on the lookout for this problem for any data types you use in large numbers.</p>
<p>Fortunately, changing the order of stored properties is always source-compatible, and is binary-compatible too (a.k.a. &#8220;ABI-compatible&#8221;) for <a href="https://github.com/apple/swift/blob/main/docs/LibraryEvolution.rst#classes" data-wpel-link="external" target="_blank" rel="external noopener">classes &amp; actors</a>, as well as <a href="https://github.com/apple/swift/blob/main/docs/LibraryEvolution.rst#structs" data-wpel-link="external" target="_blank" rel="external noopener">non-frozen structs</a>.  So even if you don&#8217;t catch the problem immediately, you might still be able to fix it.</p>
<div class="wp-block-group is-layout-constrained wp-block-group-is-layout-constrained"><div class="wp-block-group__inner-container"> <p> Although we&#8217;ve been looking at structs here, know that this all applies similarly to classes &amp; actors. The main difference is that every class or actor &#8211; in fact, any reference type &#8211; is <em>at least</em> sixteen bytes irrespective of what stored properties it has. Its alignment is likewise always <em>at least</em> sixteen bytes<sup data-fn="69e5ba4a-f757-497e-9fb7-1f1652436f33" class="fn"><a href="#69e5ba4a-f757-497e-9fb7-1f1652436f33" id="69e5ba4a-f757-497e-9fb7-1f1652436f33-link">5</a></sup>. So the padding problems, and wasted space that result from them, tend to be even worse with classes &amp; actors.</p></div></div><h2 class="wp-block-heading"><span id="Bools_are_bytes_not_bits">Bools are bytes, not bits</span></h2>
<p>In principle a boolean uses just a single bit of memory &#8211; true or false, 1 or 0.  Unfortunately, high-level languages like Swift tend to think of everything as <em>bytes</em>, not bits, and the smallest number of bytes is one &#8211; <em>eight</em> bits.</p>
<p>We saw this in the beginning, with <code>Bool</code> taking a whole byte even though it only uses an eighth of that memory.</p>
<p>Unfortunately, this carries over even to collections of <code>Bool</code>s.</p>
<div class="wp-block-kevinbatdorf-code-block-pro padding-disabled" data-code-block-pro-font-family="" style="font-size:.875rem;line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code><span class="line"><span style="color: #0000FF">struct</span><span style="color: #000000"> </span><span style="color: #267F99">ManyBooleans</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> a: </span><span style="color: #267F99">Bool</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> b: </span><span style="color: #267F99">Bool</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> c: </span><span style="color: #267F99">Bool</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> d: </span><span style="color: #267F99">Bool</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> e: </span><span style="color: #267F99">Bool</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> f: </span><span style="color: #267F99">Bool</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> g: </span><span style="color: #267F99">Bool</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> h: </span><span style="color: #267F99">Bool</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><p>In some languages, <code>ManyBooleans</code> would take up just one byte.  It has eight booleans, which need eight bits, which can be packed together into a single byte.  Perfect!</p>
<p>Unfortunately, Swift does not do that currently<sup data-fn="704b9877-db92-45a0-b3a3-07dec843e615" class="fn"><a href="#704b9877-db92-45a0-b3a3-07dec843e615" id="704b9877-db92-45a0-b3a3-07dec843e615-link">6</a></sup>.  In Swift, <code>ManyBooleans</code> is eight bytes.  It has an alignment of just one, so at least it never wastes any space with padding.  Nonetheless, it still takes up <em>eight times</em> as much memory as it needs to. </p>
<p>This applies similarly to collections of <code>Bool</code>s, like <code>Array</code>s.  A <code>[Bool]</code> takes up one byte per entry, not one bit.  There is no native equivalent to C++&#8217;s <code><a href="https://en.cppreference.com/w/cpp/container/vector_bool" data-wpel-link="external" target="_blank" rel="external noopener">vector&lt;bool></a></code> in Swift (Swift does not support template specialisation in that sense), although <a href="https://github.com/apple/swift-collections" data-wpel-link="external" target="_blank" rel="external noopener">swift-collections</a> does contain <code><a href="https://swiftpackageindex.com/apple/swift-collections/main/documentation/bitcollections/bitarray" data-wpel-link="external" target="_blank" rel="external noopener">BitArray</a></code> (and <code><a href="https://swiftpackageindex.com/apple/swift-collections/main/documentation/bitcollections/bitset" data-wpel-link="external" target="_blank" rel="external noopener">BitSet</a></code>) collections that you can use manually (but you have to remember to use them!).</p>
<div class="wp-block-group is-layout-constrained wp-block-group-is-layout-constrained"><div class="wp-block-group__inner-container"> <p> I want to call out that these bit-efficient collections were added through a <a href="https://summerofcode.withgoogle.com" data-wpel-link="external" target="_blank" rel="external noopener">Google Summer of Code</a> project, by <a href="https://forums.swift.org/u/MahanazAtiqullah/summary" data-wpel-link="external" target="_blank" rel="external noopener">Mahanaz Atiqullah</a> with mentoring by <a href="https://forums.swift.org/u/david_smith/summary" data-wpel-link="external" target="_blank" rel="external noopener">David Smith</a>, <a href="https://forums.swift.org/u/lorentey/summary" data-wpel-link="external" target="_blank" rel="external noopener">Karoy Lorentey</a>, and <a href="https://forums.swift.org/u/kylemacomber/summary" data-wpel-link="external" target="_blank" rel="external noopener">Kyle Macomber</a>. See <a href="https://forums.swift.org/t/bit-array-and-bit-set-api-review-the-end-of-a-gsoc-project/51396/1" data-wpel-link="external" target="_blank" rel="external noopener">her project presentation</a> for details and some benchmark numbers showing that these specialised collections are not just much more memory efficient but <em>much</em> faster as well.</p></div></div><h2 class="wp-block-heading"><span id="except_when_they8217re_not">except when they&#8217;re not</span></h2>
<figure class="wp-block-table aligncenter"><table><thead><tr><th class="has-text-align-right" data-align="right">Type</th><th class="has-text-align-center" data-align="center">Nominal Size</th><th class="has-text-align-center" data-align="center">Contiguous Size</th><th class="has-text-align-center" data-align="center">Alignment</th><th class="has-text-align-center" data-align="center">Actual Size (Stride)</th><th class="has-text-align-center" data-align="center">Internal Padding</th><th class="has-text-align-center" data-align="center">Trailing Padding</th></tr></thead><tbody><tr><td class="has-text-align-right" data-align="right">Bool</td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">0</td><td class="has-text-align-center" data-align="center">0</td></tr><tr><td class="has-text-align-right" data-align="right">Optional&lt;Bool></td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">1</td><td class="has-text-align-center" data-align="center">0</td><td class="has-text-align-center" data-align="center">0</td></tr></tbody></table></figure>
<p>What witchcraft is this?!  We just saw that two <code>Bool</code>s do <em>not</em> share a byte in Swift, yet here we have conceptually two <code>Bool</code>s, and they&#8217;re doing exactly that!</p>
<p>This is because enums, basically.  They are a whole other kettle of fish.  I plan to do a follow-up post on their unique behaviour when it comes to memory layout.</p>
<ol class="wp-block-footnotes"><li id="13cd788d-5855-4a1e-a1bd-5d8bf2c204ed">For <em>most</em> purposes <em>in memory</em>. It may be <em>possible</em> to pack the type into a smaller space (even without using formal compression) such as for serialisation into a file or to send over a network, but in general you can&#8217;t use the type in a Swift program if it&#8217;s not properly padded to its stride and correctly aligned. <a href="#13cd788d-5855-4a1e-a1bd-5d8bf2c204ed-link" aria-label="Jump to footnote reference 1"></a></li><li id="a966f782-5d20-411c-a04b-7b82986b6617">Potentially even <em>more</em> expensive due to the indirection, although most <code>Character</code> APIs are inlinable and so tend to get compiled out by the optimiser. <a href="#a966f782-5d20-411c-a04b-7b82986b6617-link" aria-label="Jump to footnote reference 2"></a></li><li id="06c81bdc-8a1d-45ef-ba68-206050b9acd3"><a href="https://forums.swift.org/t/optimal-stored-property-packing/70327" data-wpel-link="external" target="_blank" rel="external noopener">It generally doesn&#8217;t have to though</a>, which opens up the possibility that Swift will improve this behaviour in future. <a href="#06c81bdc-8a1d-45ef-ba68-206050b9acd3-link" aria-label="Jump to footnote reference 3"></a></li><li id="7bdf4f15-e127-4de0-9256-abf550dbb5b0">The reasoning is complicated and subject to the whims of the compiler&#8217;s optimiser, but it factors in considerations such as the code size (of a single function call to <code>memcpy</code> vs potentially many separate load &amp; store instructions) and performance (at some point it becomes faster to just copy all the bytes together than copy every stored property&#8217;s bytes individually). <a href="#7bdf4f15-e127-4de0-9256-abf550dbb5b0-link" aria-label="Jump to footnote reference 4"></a></li><li id="69e5ba4a-f757-497e-9fb7-1f1652436f33">This is actually a consequence of how malloc is implemented on virtually all platforms &#8211; and certainly all of Apple&#8217;s &#8211; which is to return memory allocations that are at least sixteen bytes in size, and usually a power of two (so 16, 32, 64, 128, etc). So your class might nominally only need 65 bytes of memory per instance, but it might end up using 128. Which can make classes &amp; actors even <em>more</em> problematic regarding memory size and waste, than structs &amp; enums &#8211; a topic for a follow-up post, perhaps. <a href="#69e5ba4a-f757-497e-9fb7-1f1652436f33-link" aria-label="Jump to footnote reference 5"></a></li><li id="704b9877-db92-45a0-b3a3-07dec843e615"><a href="https://forums.swift.org/t/optimal-stored-property-packing/70327/5" data-wpel-link="external" target="_blank" rel="external noopener">It <em>could</em></a>, though, in future. <a href="#704b9877-db92-45a0-b3a3-07dec843e615-link" aria-label="Jump to footnote reference 6"></a></li></ol>
<h1 class="wp-block-heading"><span id="Appendices">Appendices</span></h1>
<h2 class="wp-block-heading" id="helper-functions"><span id="Helper_functions">Helper functions</span></h2>
<p>This post used the following core code for the data presented in the tables.  It&#8217;s pretty hacky &#8211; it doesn&#8217;t work correctly for all types, as the inline comments note, but it is sufficient for the relatively simple examples shown in this post.</p>
<div class="wp-block-kevinbatdorf-code-block-pro padding-disabled" data-code-block-pro-font-family="" style="font-size:.875rem;line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code><span class="line"><span style="color: #008000">// Table header</span></span>
<span class="line"><span style="color: #795E26">print</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;Type&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;Nominal Size&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;Contiguous Size&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;Alignment&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;Actual Size (Stride)&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;Internal padding&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #A31515">&quot;Trailing Padding&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #001080">separator</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;</span><span style="color: #EE0000">\t</span><span style="color: #A31515">&quot;</span><span style="color: #000000">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">// Table row</span></span>
<span class="line"><span style="color: #001080">func</span><span style="color: #000000"> </span><span style="color: #795E26">sizeOf</span><span style="color: #000000">&lt;</span><span style="color: #267F99">T</span><span style="color: #000000">&gt;(</span><span style="color: #001080">_</span><span style="color: #000000"> </span><span style="color: #001080">value</span><span style="color: #000000">: </span><span style="color: #0070C1">T</span><span style="color: #000000">) -&gt; </span><span style="color: #001080">Int</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">MemoryLayout</span><span style="color: #000000">&lt;</span><span style="color: #0070C1">T</span><span style="color: #000000">&gt;.</span><span style="color: #001080">size</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #001080">func</span><span style="color: #000000"> </span><span style="color: #795E26">printLayout</span><span style="color: #000000">&lt;</span><span style="color: #267F99">T</span><span style="color: #000000">&gt;(</span><span style="color: #0000FF">of</span><span style="color: #000000"> </span><span style="color: #001080">type</span><span style="color: #000000">: </span><span style="color: #0070C1">T</span><span style="color: #000000">.</span><span style="color: #001080">Type</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">                    </span><span style="color: #001080">example</span><span style="color: #000000">: </span><span style="color: #0070C1">T</span><span style="color: #000000">? = </span><span style="color: #001080">nil</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">    let </span><span style="color: #001080">nominalSize</span><span style="color: #000000"> = </span><span style="color: #001080">if</span><span style="color: #000000"> </span><span style="color: #001080">let</span><span style="color: #000000"> </span><span style="color: #001080">example</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// Note: doesn&#39;t handle recursive types (nested structs, classes, actors, enums, etc).</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//       Also not correct for primitive types (e.g. integers).</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #795E26">Mirror</span><span style="color: #000000">(</span><span style="color: #001080">reflecting</span><span style="color: #000000">: </span><span style="color: #267F99">example</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">            .children</span></span>
<span class="line"><span style="color: #000000">            .lazy</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #008000">// Have to force open the existential because Swift won&#39;t implicitly open Any in Swift 5 mode.</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #008000">// https://forums.swift.org/t/getting-the-size-of-any-value/62843/4</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #008000">// https://github.com/apple/swift-evolution/blob/main/proposals/0352-implicit-open-existentials.md#avoid-opening-when-the-existential-type-satisfies-requirements-in-swift-5</span></span>
<span class="line"><span style="color: #000000">            .map { </span><span style="color: #795E26">_openExistential</span><span style="color: #000000">(</span><span style="color: #001080">$0</span><span style="color: #000000">.</span><span style="color: #001080">value</span><span style="color: #000000">, </span><span style="color: #001080">do</span><span style="color: #000000">: </span><span style="color: #001080">sizeOf</span><span style="color: #000000">) }</span></span>
<span class="line"><span style="color: #000000">            .reduce(</span><span style="color: #001080">into:</span><span style="color: #000000"> </span><span style="color: #098658">0</span><span style="color: #000000">, +=)</span></span>
<span class="line"><span style="color: #000000">    } </span><span style="color: #001080">else</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">        MemoryLayout&lt;T&gt;.</span><span style="color: #001080">size</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #795E26">print</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;</span><span style="color: #EE0000">\(</span><span style="color: #A31515">type):&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #001080">nominalSize</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #001080">MemoryLayout</span><span style="color: #000000">&lt;</span><span style="color: #001080">T</span><span style="color: #000000">&gt;.size,</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #001080">MemoryLayout</span><span style="color: #000000">&lt;</span><span style="color: #001080">T</span><span style="color: #000000">&gt;.alignment,</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #001080">MemoryLayout</span><span style="color: #000000">&lt;</span><span style="color: #001080">T</span><span style="color: #000000">&gt;.stride,</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #001080">MemoryLayout</span><span style="color: #000000">&lt;</span><span style="color: #001080">T</span><span style="color: #000000">&gt;.size - </span><span style="color: #001080">nominalSize</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #001080">MemoryLayout</span><span style="color: #000000">&lt;</span><span style="color: #001080">T</span><span style="color: #000000">&gt;.stride - </span><span style="color: #001080">MemoryLayout</span><span style="color: #000000">&lt;</span><span style="color: #001080">T</span><span style="color: #000000">&gt;.size,</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #001080">separator</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;</span><span style="color: #EE0000">\t</span><span style="color: #A31515">&quot;</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><div class="crp_related crp-thumbs-grid"><h4>Moar posts</h4><ul><li><a href="https://wadetregaskis.com/undocumented-swift-conditional-compilation-macros/" class="crp_link post-3856" data-wpel-link="internal"><figure><img width="256" height="256" src="https://wadetregaskis.com/wp-content/uploads/2023/12/Blank-pixel.png" class="crp_thumb crp_default_thumb" alt="Undocumented Swift conditional compilation macros" title="Undocumented Swift conditional compilation macros" srcset="https://wadetregaskis.com/wp-content/uploads/2023/12/Blank-pixel.png 1w, https://wadetregaskis.com/wp-content/uploads/2023/12/Blank-pixel@2x.png 2w" sizes="(max-width: 256px) 100vw, 256px" srcset="https://wadetregaskis.com/wp-content/uploads/2023/12/Blank-pixel.png 1w, https://wadetregaskis.com/wp-content/uploads/2023/12/Blank-pixel@2x.png 2w"/></figure><span class="crp_title">Undocumented Swift conditional compilation macros</span></a></li><li><a href="https://wadetregaskis.com/live-swift-playground-in-bing-search-results/" class="crp_link post-3843" data-wpel-link="internal"><figure><img width="256" height="202" src="https://wadetregaskis.com/wp-content/uploads/2017/01/Screen-Shot-2017-01-07-at-11.13.32-am-256x202.webp" class="crp_thumb crp_featured" alt="Screenshot of Bing search results for the query &quot;Swift enums&quot; showing a live Swift playground with example enum code pre-inserted" title="Live Swift playground in Bing search results" srcset="https://wadetregaskis.com/wp-content/uploads/2017/01/Screen-Shot-2017-01-07-at-11.13.32-am-256x202.webp 256w, https://wadetregaskis.com/wp-content/uploads/2017/01/Screen-Shot-2017-01-07-at-11.13.32-am-512x404@2x.webp 1024w, https://wadetregaskis.com/wp-content/uploads/2017/01/Screen-Shot-2017-01-07-at-11.13.32-am-512x404.webp 512w, https://wadetregaskis.com/wp-content/uploads/2017/01/Screen-Shot-2017-01-07-at-11.13.32-am.webp 1722w" sizes="(max-width: 256px) 100vw, 256px"/></figure><span class="crp_title">Live Swift playground in Bing search results</span></a></li><li><a href="https://wadetregaskis.com/ambiguous-reference-to-member-joined/" class="crp_link post-3807" data-wpel-link="internal"><figure><img width="256" height="109" src="https://wadetregaskis.com/wp-content/uploads/2016/12/What-Do-You-Want-Rachel-McAdams-Ryan-Gosling-In-The-Notebook-Gif-256x109.webp" class="crp_thumb crp_featured" alt="&quot;What do you want&quot; scene from The Notebook" title="ambiguous reference to member &#039;joined()&#039;" srcset="https://wadetregaskis.com/wp-content/uploads/2016/12/What-Do-You-Want-Rachel-McAdams-Ryan-Gosling-In-The-Notebook-Gif-256x109.webp 256w, https://wadetregaskis.com/wp-content/uploads/2016/12/What-Do-You-Want-Rachel-McAdams-Ryan-Gosling-In-The-Notebook-Gif.webp 459w" sizes="(max-width: 256px) 100vw, 256px"/></figure><span class="crp_title">ambiguous reference to member 'joined()'</span></a></li></ul><div class="crp_clear"></div></div></div><footer class="entry-meta" aria-label="Entry meta">
<span class="cat-links"><span class="gp-icon icon-categories"><svg viewBox="0 0 512 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"><path d="M0 112c0-26.51 21.49-48 48-48h110.014a48 48 0 0143.592 27.907l12.349 26.791A16 16 0 00228.486 128H464c26.51 0 48 21.49 48 48v224c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V112z" /></svg></span><span class="screen-reader-text">Categories </span><a href="https://wadetregaskis.com/categories/coding/" rel="category tag" data-wpel-link="internal">Coding</a></span> <span class="tags-links"><span class="gp-icon icon-tags"><svg viewBox="0 0 512 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"><path d="M20 39.5c-8.836 0-16 7.163-16 16v176c0 4.243 1.686 8.313 4.687 11.314l224 224c6.248 6.248 16.378 6.248 22.626 0l176-176c6.244-6.244 6.25-16.364.013-22.615l-223.5-224A15.999 15.999 0 00196.5 39.5H20zm56 96c0-13.255 10.745-24 24-24s24 10.745 24 24-10.745 24-24 24-24-10.745-24-24z"/><path d="M259.515 43.015c4.686-4.687 12.284-4.687 16.97 0l228 228c4.686 4.686 4.686 12.284 0 16.97l-180 180c-4.686 4.687-12.284 4.687-16.97 0-4.686-4.686-4.686-12.284 0-16.97L479.029 279.5 259.515 59.985c-4.686-4.686-4.686-12.284 0-16.97z" /></svg></span><span class="screen-reader-text">Tags </span><a href="https://wadetregaskis.com/tags/alignment/" rel="tag" data-wpel-link="internal">alignment</a>, <a href="https://wadetregaskis.com/tags/memory-efficiency/" rel="tag" data-wpel-link="internal">memory efficiency</a>, <a href="https://wadetregaskis.com/tags/memory-layout/" rel="tag" data-wpel-link="internal">memory layout</a>, <a href="https://wadetregaskis.com/tags/padding/" rel="tag" data-wpel-link="internal">padding</a>, <a href="https://wadetregaskis.com/tags/swift/" rel="tag" data-wpel-link="internal">Swift</a></span> 		<nav id="nav-below" class="post-navigation" aria-label="Posts">
<div class="nav-previous"><span class="gp-icon icon-arrow-left"><svg viewBox="0 0 192 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M178.425 138.212c0 2.265-1.133 4.813-2.832 6.512L64.276 256.001l111.317 111.277c1.7 1.7 2.832 4.247 2.832 6.513 0 2.265-1.133 4.813-2.832 6.512L161.43 394.46c-1.7 1.7-4.249 2.832-6.514 2.832-2.266 0-4.816-1.133-6.515-2.832L16.407 262.514c-1.699-1.7-2.832-4.248-2.832-6.513 0-2.265 1.133-4.813 2.832-6.512l131.994-131.947c1.7-1.699 4.249-2.831 6.515-2.831 2.265 0 4.815 1.132 6.514 2.831l14.163 14.157c1.7 1.7 2.832 3.965 2.832 6.513z" fill-rule="nonzero" /></svg></span><span class="prev"><a href="https://wadetregaskis.com/swift-print-takes-multiple-arguments/" rel="prev" data-wpel-link="internal">Swift `print` takes multiple arguments</a></span></div><div class="nav-next"><span class="gp-icon icon-arrow-right"><svg viewBox="0 0 192 512" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M178.425 256.001c0 2.266-1.133 4.815-2.832 6.515L43.599 394.509c-1.7 1.7-4.248 2.833-6.514 2.833s-4.816-1.133-6.515-2.833l-14.163-14.162c-1.699-1.7-2.832-3.966-2.832-6.515 0-2.266 1.133-4.815 2.832-6.515l111.317-111.316L16.407 144.685c-1.699-1.7-2.832-4.249-2.832-6.515s1.133-4.815 2.832-6.515l14.163-14.162c1.7-1.7 4.249-2.833 6.515-2.833s4.815 1.133 6.514 2.833l131.994 131.993c1.7 1.7 2.832 4.249 2.832 6.515z" fill-rule="nonzero" /></svg></span><span class="next"><a href="https://wadetregaskis.com/beware-of-specifying-isolation-requirements-for-whole-protocols/" rel="next" data-wpel-link="internal">Beware of specifying isolation requirements for whole protocols</a></span></div></nav>
</footer></div></article>
<div class="comments-area">
<div id="comments">
<div id="respond" class="comment-respond">
<h3 id="reply-title" class="comment-reply-title">Leave a Comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/a-brief-introduction-to-type-memory-layout-in-swift/#respond" style="display:none;" data-wpel-link="internal">Cancel reply</a></small></h3><form action="https://wadetregaskis.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment" class="screen-reader-text">Comment</label><textarea id="comment" name="comment" cols="45" rows="8" required></textarea></p><label for="author" class="screen-reader-text">Name</label><input placeholder="Name (optional)" id="author" name="author" type="text" value="" size="30" />
<label for="email" class="screen-reader-text">Email</label><input placeholder="Email (optional unless you wish to receive reply notifications)" id="email" name="email" type="email" value="" size="30" />
<label for="url" class="screen-reader-text">Website</label><input placeholder="Website (optional)" id="url" name="url" type="url" value="" size="30" />
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="comment-subscription-form"><input type="checkbox" name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts by email.</label></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='7803' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="b399d34cfa" /></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="147"/></p></form></div></div></div></main></div></div></div><div class="site-footer footer-bar-active footer-bar-align-center">
<footer class="site-info" aria-label="Site" itemtype="https://schema.org/WPFooter" itemscope>
<div class="inside-site-info grid-container">
<div class="footer-bar">
<aside id="block-39" class="widget inner-padding widget_block">
<div class="wp-block-columns are-vertically-aligned-center is-layout-flex wp-container-core-columns-layout-1 wp-block-columns-is-layout-flex">
<div class="wp-block-column is-vertically-aligned-center is-layout-flow wp-block-column-is-layout-flow"> <p><a href="https://wadetregaskis.com/feed" data-type="link" data-id="https://wadetregaskis.com/feed" data-wpel-link="internal">RSS (Posts)</a></p></div><div class="wp-block-column is-vertically-aligned-center is-layout-flow wp-block-column-is-layout-flow"> <p><a href="https://wadetregaskis.com/feed" data-type="link" data-id="https://wadetregaskis.com/feed" data-wpel-link="internal"></a><a href="https://wadetregaskis.com/comments/feed" data-wpel-link="internal">RSS (Comments)</a></p></div><div class="wp-block-column is-vertically-aligned-center is-layout-flow wp-block-column-is-layout-flow"> <p class="has-13-px-font-size">Mastodon: @everything@wadetregaskis.com</p></div></div></aside><aside id="block-41" class="widget inner-padding widget_block widget_text">
<p class="has-text-align-center"><a href="https://wadetregaskis.com/how-to-follow-this-website/" data-wpel-link="internal">Other ways to follow this website</a></p>
</aside></div><div class="copyright-bar"> <span class="copyright">&copy; 2024 Wade Tregaskis</span> &bull; Built with <a href="https://generatepress.com" itemprop="url" data-wpel-link="external" target="_blank" rel="external noopener">GeneratePress</a></div></div></footer></div><style>#toc_container li,#toc_container ul{margin:0;padding:0}#toc_container.no_bullets li,#toc_container.no_bullets ul,#toc_container.no_bullets ul li,.toc_widget_list.no_bullets,.toc_widget_list.no_bullets li{background:0 0;list-style-type:none;list-style:none}#toc_container.have_bullets li{padding-left:12px}#toc_container ul ul{margin-left:1.5em}#toc_container{background:#f9f9f9;border:1px solid #aaa;padding:10px;margin-bottom:1em;width:auto;display:table;font-size:95%}#toc_container.toc_light_blue{background:#edf6ff}#toc_container.toc_white{background:#fff}#toc_container.toc_black{background:#000}#toc_container.toc_transparent{background:none transparent}#toc_container p.toc_title{text-align:center;font-weight:700;margin:0;padding:0}#toc_container.toc_black p.toc_title{color:#aaa}#toc_container span.toc_toggle{font-weight:400;font-size:90%}#toc_container p.toc_title+ul.toc_list{margin-top:1em}.toc_wrap_left{float:left;margin-right:10px}.toc_wrap_right{float:right;margin-left:10px}#toc_container a{text-decoration:none;text-shadow:none}#toc_container a:hover{text-decoration:underline}.toc_sitemap_posts_letter{font-size:1.5em;font-style:italic}</style>
<script id="generate-menu-js-extra">var generatepressMenu={"toggleOpenedSubMenus":"1","openSubMenuLabel":"Open Sub-Menu","closeSubMenuLabel":"Close Sub-Menu"};</script>
<script id="generate-navigation-search-js-extra">var generatepressNavSearch={"open":"Open Search Bar","close":"Close Search Bar"};</script>
<script   id="wp-data-js-after">(function(){
var userId=0;
var storageKey="WP_DATA_USER_" + userId;
wp.data
.use(wp.data.plugins.persistence, { storageKey: storageKey });
})();</script>
<script   id="activitypub-remote-reply-js-before">var _activityPubOptions={"namespace":"activitypub\/1.0"};</script>
<script id="toc-front-js-extra">var tocplus={"visibility_show":"show","visibility_hide":"hide","visibility_hide_by_default":"1","width":"Auto","smooth_scroll_offset":"40"};</script>
<script>document.getElementById("ak_js_1").setAttribute("value",(new Date()).getTime());</script>
<script id="generate-a11y">!function(){"use strict";if("querySelector"in document&&"addEventListener"in window){var e=document.body;e.addEventListener("mousedown",function(){e.classList.add("using-mouse")}),e.addEventListener("keydown",function(){e.classList.remove("using-mouse")})}}();</script>
<script>for (element of document.getElementsByClassName("wp-block-image-comparison-image-comparison")){
element.addEventListener("mousedown", function(e){ e.preventDefault() });
}</script>
<!--[if lte IE 11]><script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/drvv07tl/hrg5k.js" id="generate-classlist-js"></script><![endif]-->
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/kpoa87rp/hrg5k.js" id="generate-menu-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/7ll8ob2i/hrg5k.js" id="generate-navigation-search-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/qku2wekp/hrg5k.js" id="comment-reply-js" async data-wp-strategy="async"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/euivhoc5/htc2q.js" id="wp-polyfill-inert-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/8nc4g93m/htc2q.js" id="regenerator-runtime-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/6nd5vvfj/htc2q.js" id="wp-polyfill-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/48swnp1/ir3w.js" id="wp-hooks-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/jzv3k6c8/ir3w.js" id="wp-i18n-js"></script>
<script   id="wp-i18n-js-after">wp.i18n.setLocaleData({ 'text direction\u0004ltr': [ 'ltr' ] });</script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/6olkne6j/ir3w.js" id="wp-url-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/2lilpyx/ir3w.js" id="wp-api-fetch-js"></script>
<script   id="wp-api-fetch-js-after">wp.apiFetch.use(wp.apiFetch.createRootURLMiddleware("https://wadetregaskis.com/wp-json/"));
wp.apiFetch.nonceMiddleware=wp.apiFetch.createNonceMiddleware("cde2fccc74");
wp.apiFetch.use(wp.apiFetch.nonceMiddleware);
wp.apiFetch.use(wp.apiFetch.mediaUploadMiddleware);
wp.apiFetch.nonceEndpoint="https://wadetregaskis.com/wp-admin/admin-ajax.php?action=rest-nonce";</script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/3111nlzs/htc2q.js" id="react-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/kcwarov7/htc2q.js" id="react-dom-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/8z07t2gh/hunvq.js" id="wp-dom-ready-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/loxsf1t6/ir3w.js" id="wp-a11y-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/l1ytpw6w/ir3w.js" id="wp-deprecated-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/1bmzuy49/ir3w.js" id="wp-dom-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/2f3hghas/htc2q.js" id="wp-escape-html-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/kd9ygl9b/htc2q.js" id="wp-element-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/2nxuwalp/ir3w.js" id="wp-is-shallow-equal-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/d3s3w6bo/ir3w.js" id="wp-keycodes-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/1omxlcix/ir3l.js" id="wp-priority-queue-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/1mzf18uz/ir3l.js" id="wp-compose-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/kca0ae05/ir3l.js" id="moment-js"></script>
<script   id="moment-js-after">moment.updateLocale('en_US', {"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"week":{"dow":1},"longDateFormat":{"LT":"g:i A","LTS":null,"L":null,"LL":"F j, Y","LLL":"F j, Y g:i a","LLLL":null}});</script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/ftg1u70w/ir3l.js" id="wp-date-js"></script>
<script   id="wp-date-js-after">wp.date.setSettings({"l10n":{"locale":"en_US","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"},"relative":{"future":"%s from now","past":"%s ago","s":"a second","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"startOfWeek":1},"formats":{"time":"g:i A","date":"F j, Y","datetime":"F j, Y g:i a","datetimeAbbreviated":"M j, Y g:i a"},"timezone":{"offset":-8,"string":"America\/Los_Angeles","abbr":"PST"}});</script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/kctypkoi/ir3l.js" id="wp-html-entities-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/duak6jg3/ir3l.js" id="wp-primitives-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/t02iwvf/ir3l.js" id="wp-private-apis-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/fi2b8mwc/ir3l.js" id="wp-redux-routine-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/22x1cm8o/ir3l.js" id="wp-data-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/98u00uj5/ir3l.js" id="wp-rich-text-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/h3ceawy/ir3l.js" id="wp-warning-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/jmxkvqk4/ir3l.js" id="wp-components-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/6xi9kbho/ir3k.js" id="activitypub-remote-reply-js"></script>
<script src="https://stats.wp.com/e-202409.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script   id="jetpack-stats-js-after">_stq=window._stq||[];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"226351702\",\"post\":\"7803\",\"tz\":\"-8\",\"srv\":\"wadetregaskis.com\",\"j\":\"1:13.1.3\"}") ]);
_stq.push([ "clickTrackerInit", "226351702", "7803" ]);</script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/kqagqhvu/hrgfq.js" id="kevinbatdorf-code-block-pro-view-script-js" data-wp-strategy="defer"></script>
<script   id="kevinbatdorf-code-block-pro-view-script-js-after">window.codeBlockPro={"pluginUrl":"https:\/\/wadetregaskis.com\/wp-content\/plugins\/code-block-pro\/"};</script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/77cllf4w/hrgf0.js" id="jquery-core-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/30xvcko1/hrgf0.js" id="jquery-migrate-js"></script>
<script src="//wadetregaskis.com/wp-content/cache/wpfc-minified/1zt5ol55/hrgf0.js" id="toc-front-js"></script>
<script defer src="//wadetregaskis.com/wp-content/cache/wpfc-minified/jot62imt/hrg5k.js" id="akismet-frontend-js"></script>
<script>document.addEventListener("DOMContentLoaded", function(){
const headerLevels=new Map(Array.from(jQuery(".entry-content :header:not(.crp_related *)").toArray().map(function (f){ return f.localName }).sort().filter(function (e, i, a){ return i===a.indexOf(e) }).entries()).map(function (x){ return [x[1], x[0]]; })); 
for (const [i, headerName] of ["h2", "h3", "h4"].entries()){
var header=jQuery(`.entry-content ${headerName}:not(.crp_related *)`);
const headerDepth=headerLevels.get(headerName);
if(0==headerDepth){
continue;
}
const className=`ss${headerDepth}`;
header.addClass(className);
var subsection=header.nextUntil(":header, sharedaddy, .crp_related, .wp-block-footnotes").filter(":not(.aligncenter)").filter("p, pre, code, ul, ol, .wp-block-group, .wp-block-syntaxhighlighter-code").addClass(className);
}});</script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/v84a3a4012de94ce1a686ba8c167c359c1696973893317" integrity="sha512-euoFGowhlaLqXsPWQ48qSkBSCFs3DPRyiwVu3FjR96cMPx+Fr+gpWRhIafcHwqwCqWS42RZhIudOvEI+Ckf6MA==" data-cf-beacon='{"rayId":"85e25b7469f2079d","r":1,"version":"2024.2.4","token":"d8957dbc2cc741ed957ff78216e41ceb"}' crossorigin="anonymous"></script>
</body>
</html><!-- WP Fastest Cache file was created in 5.7269480228424 seconds, on 01-03-24 15:53:51 -->
